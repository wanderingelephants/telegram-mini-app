import{Z as qe,$ as ut,a0 as He,E as G,a1 as dt,d as Ye,r as je,a2 as ct,a3 as Ce,a4 as mt,a5 as ve,a6 as ft,a7 as vt,M as pt,W as gt,a8 as Ae,_ as Ge,A as q,C as N,a9 as he,p as Z,z as H,x as be,y as se,o as re,Y as De,i as Fe,aa as Ee,j as ke,m as ht,a as yt,b as bt,c as _t,u as kt,e as wt,f as St,g as Vt,V as Me,h as xt,k as Ct,l as Ft,n as Tt,q as Rt,P as Pt,s as Ot,v as Le,G as It,B as Be,w as At}from"./index-CQ-ZzBhf.js";import{T as Dt,p as ue,J as We,m as Et,b as Mt,g as de,W as Ke,d as Lt,B as ie,z as Bt,ax as Wt,E as zt,f as ce,a0 as Re,h as Ut,s as Nt,l as $t,o as qt,Q as Ht,O as Yt,av as jt,aG as Gt,aw as Kt,$ as ze,G as Jt}from"./vuetify-zmNfPkyK.js";import{c as P,s as ne,m as a,F as U,n as E,Q as f,d as oe,f as Xt,E as X,N as D,S as Q,P as l,R as p,V as h,U as fe,O as j,_ as Te,w as ye,A as Ue,$ as Qt}from"./vue-BQEgaIvT.js";import{V as Ne}from"./VDialog-1PZF7vWM.js";import{V as Zt}from"./VSnackbar-dD08cXAg.js";import"./apexcharts-D4WdCuSv.js";const xe=Dt("v-spacer","div","VSpacer"),ea=ue({name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:We,default:"$ratingEmpty"},fullIcon:{type:We,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:[Number,String],default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},ripple:Boolean,...Et(),...qe(),...ut(),...He(),...Mt()},"VRating"),$e=de()({name:"VRating",props:ea(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:s}=t;const{t:i}=Ke(),{themeClasses:r}=Lt(e),d=ie(e,"modelValue"),n=P(()=>Bt(parseFloat(d.value),0,+e.length)),S=P(()=>Wt(Number(e.length),1)),b=P(()=>S.value.flatMap(y=>e.halfIncrements?[y-.5,y]:[y])),u=ne(-1),w=P(()=>b.value.map(y=>{const C=e.hover&&u.value>-1,F=n.value>=y,V=u.value>=y,_=(C?V:F)?e.fullIcon:e.emptyIcon,m=e.activeColor??e.color,$=F||V?m:e.color;return{isFilled:F,isHovered:V,icon:_,color:$}})),v=P(()=>[0,...b.value].map(y=>{function C(){u.value=y}function F(){u.value=-1}function V(){e.disabled||e.readonly||(d.value=n.value===y&&e.clearable?0:y)}return{onMouseenter:e.hover?C:void 0,onMouseleave:e.hover?F:void 0,onClick:V}})),c=P(()=>e.name??`v-rating-${zt()}`);function x(y){var Y,ee;let{value:C,index:F,showStar:V=!0}=y;const{onMouseenter:L,onMouseleave:_,onClick:m}=v.value[F+1],$=`${c.value}-${String(C).replace(".","-")}`,B={color:(Y=w.value[F])==null?void 0:Y.color,density:e.density,disabled:e.disabled,icon:(ee=w.value[F])==null?void 0:ee.icon,ripple:e.ripple,size:e.size,variant:"plain"};return a(U,null,[a("label",{for:$,class:{"v-rating__item--half":e.halfIncrements&&C%1>0,"v-rating__item--full":e.halfIncrements&&C%1===0},onMouseenter:L,onMouseleave:_,onClick:m},[a("span",{class:"v-rating__hidden"},[i(e.itemAriaLabel,C,e.length)]),V?s.item?s.item({...w.value[F],props:B,value:C,index:F,rating:n.value}):a(G,E({"aria-label":i(e.itemAriaLabel,C,e.length)},B),null):void 0]),a("input",{class:"v-rating__hidden",name:c.value,id:$,type:"radio",value:C,checked:n.value===C,tabindex:-1,readonly:e.readonly,disabled:e.disabled},null)])}function M(y){return s["item-label"]?s["item-label"](y):y.label?a("span",null,[y.label]):a("span",null,[f(" ")])}return ce(()=>{var C;const y=!!((C=e.itemLabels)!=null&&C.length)||s["item-label"];return a(e.tag,{class:["v-rating",{"v-rating--hover":e.hover,"v-rating--readonly":e.readonly},r.value,e.class],style:e.style},{default:()=>[a(x,{value:0,index:-1,showStar:!1},null),S.value.map((F,V)=>{var L,_;return a("div",{class:"v-rating__wrapper"},[y&&e.itemLabelPosition==="top"?M({value:F,index:V,label:(L=e.itemLabels)==null?void 0:L[V]}):void 0,a("div",{class:"v-rating__item"},[e.halfIncrements?a(U,null,[a(x,{value:F-.5,index:V*2},null),a(x,{value:F,index:V*2+1},null)]):a(x,{value:F,index:V},null)]),y&&e.itemLabelPosition==="bottom"?M({value:F,index:V,label:(_=e.itemLabels)==null?void 0:_[V]}):void 0])})]})}),{}}}),Pe=Symbol.for("vuetify:v-tabs"),ta=ue({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Re(dt({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),_e=de()({name:"VTab",props:ta(),setup(e,t){let{slots:s,attrs:i}=t;const{textColorClasses:r,textColorStyles:d}=Ye(e,"sliderColor"),n=oe(),S=oe(),b=P(()=>e.direction==="horizontal"),u=P(()=>{var v,c;return((c=(v=n.value)==null?void 0:v.group)==null?void 0:c.isSelected.value)??!1});function w(v){var x,M;let{value:c}=v;if(c){const y=(M=(x=n.value)==null?void 0:x.$el.parentElement)==null?void 0:M.querySelector(".v-tab--selected .v-tab__slider"),C=S.value;if(!y||!C)return;const F=getComputedStyle(y).color,V=y.getBoundingClientRect(),L=C.getBoundingClientRect(),_=b.value?"x":"y",m=b.value?"X":"Y",$=b.value?"right":"bottom",B=b.value?"width":"height",Y=V[_],ee=L[_],I=Y>ee?V[$]-L[$]:V[_]-L[_],te=Math.sign(I)>0?b.value?"right":"bottom":Math.sign(I)<0?b.value?"left":"top":"center",we=(Math.abs(I)+(Math.sign(I)<0?V[B]:L[B]))/Math.max(V[B],L[B])||0,me=V[B]/L[B]||0,le=1.5;Ut(C,{backgroundColor:[F,"currentcolor"],transform:[`translate${m}(${I}px) scale${m}(${me})`,`translate${m}(${I/le}px) scale${m}(${(we-1)/le+1})`,"none"],transformOrigin:Array(3).fill(te)},{duration:225,easing:Nt})}}return ce(()=>{const v=G.filterProps(e);return a(G,E({symbol:Pe,ref:n,class:["v-tab",e.class],style:e.style,tabindex:u.value?0:-1,role:"tab","aria-selected":String(u.value),active:!1},v,i,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":w}),{...s,default:()=>{var c;return a(U,null,[((c=s.default)==null?void 0:c.call(s))??e.text,!e.hideSlider&&a("div",{ref:S,class:["v-tab__slider",r.value],style:d.value},null)])}})}),je({},n)}}),aa=ue({...Re(ct(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),la=de()({name:"VTabsWindow",props:aa(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:s}=t;const i=Xt(Pe,null),r=ie(e,"modelValue"),d=P({get(){var n;return r.value!=null||!i?r.value:(n=i.items.value.find(S=>i.selected.value.includes(S.id)))==null?void 0:n.value},set(n){r.value=n}});return ce(()=>{const n=Ce.filterProps(e);return a(Ce,E({_as:"VTabsWindow"},n,{modelValue:d.value,"onUpdate:modelValue":S=>d.value=S,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),s)}),{}}}),na=ue({...mt()},"VTabsWindowItem"),sa=de()({name:"VTabsWindowItem",props:na(),setup(e,t){let{slots:s}=t;return ce(()=>{const i=ve.filterProps(e);return a(ve,E({_as:"VTabsWindowItem"},i,{class:["v-tabs-window-item",e.class],style:e.style}),s)}),{}}});function oa(e){return e?e.map(t=>Ht(t)?t:{text:t,value:t}):[]}const ia=ue({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...ft({mandatory:"force",selectedClass:"v-tab-item--selected"}),...qe(),...He()},"VTabs"),ra=de()({name:"VTabs",props:ia(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:s,slots:i}=t;const r=ie(e,"modelValue"),d=P(()=>oa(e.items)),{densityClasses:n}=vt(e),{backgroundColorClasses:S,backgroundColorStyles:b}=pt(X(e,"bgColor")),{scopeId:u}=gt();return $t({VTab:{color:X(e,"color"),direction:X(e,"direction"),stacked:X(e,"stacked"),fixed:X(e,"fixedTabs"),sliderColor:X(e,"sliderColor"),hideSlider:X(e,"hideSlider")}}),ce(()=>{const w=Ae.filterProps(e),v=!!(i.window||e.items.length>0);return a(U,null,[a(Ae,E(w,{modelValue:r.value,"onUpdate:modelValue":c=>r.value=c,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},n.value,S.value,e.class],style:[{"--v-tabs-height":qt(e.height)},b.value,e.style],role:"tablist",symbol:Pe},u,s),{default:()=>{var c;return[((c=i.default)==null?void 0:c.call(i))??d.value.map(x=>{var M;return((M=i.tab)==null?void 0:M.call(i,{item:x}))??a(_e,E(x,{key:x.text,value:x.value}),{default:i[`tab.${x.value}`]?()=>{var y;return(y=i[`tab.${x.value}`])==null?void 0:y.call(i,{item:x})}:void 0})})]}}),v&&a(la,E({modelValue:r.value,"onUpdate:modelValue":c=>r.value=c,key:"tabs-window"},u),{default:()=>{var c;return[d.value.map(x=>{var M;return((M=i.item)==null?void 0:M.call(i,{item:x}))??a(sa,{value:x.value},{default:()=>{var y;return(y=i[`item.${x.value}`])==null?void 0:y.call(i,{item:x})}})}),(c=i.window)==null?void 0:c.call(i)]}})])}),{}}}),ua={name:"MFAnalysis",components:{},props:{analysisReport:{type:Object,required:!0}},data:()=>({showDialog:!1,showSectorDetails:!1,selectedOverlap:null,activeTab:0,downloading:!1,overlapHeaders:[{title:"Fund 1",key:"fund1_name"},{title:"Fund 2",key:"fund2_name"},{title:"Overlap %",key:"overlap_percentage"},{title:"Actions",key:"actions",sortable:!1}],expenseHeaders:[{title:"Fund Name",key:"fund_name"},{title:"Expense Ratio",key:"expense_ratio"},{title:"Category Average",key:"category_avg"},{title:"Relative Cost",key:"relative_cost"}],etfRecommendationHeaders:[{title:"Fund Name",key:"fund_name"},{title:"ETF Name",key:"etf"},{title:"Overlap %",key:"overlap_percentage"},{title:"ETF Fee %",key:"etf_fee"},{title:"Fund Fee %",key:"fund_fee"},{title:"Potential Savings %",key:"potential_savings"}]}),computed:{sectorChartSeries(){return Object.values(this.analysisReport.diversification.sector_breakdown).map(e=>e.percentage)},formattedEtfRecommendations(){const e=[];return console.log(this.analysisReport.recommendedETFs),Object.entries(this.analysisReport.recommendedETFs).forEach(([t,s])=>{console.log([t,s]),s.length>0&&s.forEach(i=>{e.push({fund_name:t,etf:i.etf,overlap_percentage:i["overlap%"],etf_fee:i.etf_fee,fund_fee:i.fund_fee,potential_savings:i.potential_savings})})}),console.log("computed formattedEtfRecom",e),e},sectorChartOptions(){return{chart:{type:"donut",animations:{dynamicAnimation:{enabled:!0}}},labels:Object.keys(this.analysisReport.diversification.sector_breakdown),plotOptions:{pie:{donut:{size:"65%"}}},tooltip:{y:{formatter:e=>`${e.toFixed(1)}%`}},legend:{position:"bottom",horizontalAlign:"center",fontSize:"14px",markers:{width:12,height:12,radius:12}},responsive:[{breakpoint:480,options:{chart:{width:300},legend:{position:"bottom"}}}],dataLabels:{enabled:!1},colors:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0","#3F51B5","#546E7A","#D4526E","#8D5B4C","#F86624","#D7263D","#1B998B","#2E294E","#F46036","#E2C044"]}},sectorTableData(){const e=this.analysisReport.diversification.sector_breakdown;return Object.entries(e).map(([t,s])=>({name:t,percentage:s.percentage}))},sectorHeaders(){return[{title:"Sector",key:"name"},{title:"Allocation (%)",key:"percentage"}]},formattedOverlaps(){return this.analysisReport.overlaps.overlaps.map(e=>({fund1_name:e.comparison_metadata.fund1.name,fund2_name:e.comparison_metadata.fund2.name,overlap_percentage:e.overlap_percentage,...e})).sort((e,t)=>t.overlap_percentage-e.overlap_percentage)}},methods:{getOverlapColor(e){return e>=25?"red":e>=15?"orange":"green"},getDiversificationColor(e){return{"over-diversified":"orange",concentrated:"red",optimal:"green"}[e]||"grey"},getCategoryColor(e){return{"large cap":"blue","mid cap":"purple","small cap":"deep-purple","multi cap":"indigo"}[e.toLowerCase()]||"grey"},getExpenseColor(e){return e>.5?"red":e<-.5?"green":"orange"},showOverlapDetails(e){this.selectedOverlap=e,this.showDialog=!0},async downloadCompleteReport(){this.downloading=!0;try{const e=new jsPDF("p","mm","a4");let t=10;e.setFontSize(18),e.text("Mutual Fund Analysis Report",105,t,{align:"center"}),t+=15,e.setFontSize(14),e.text("1. Portfolio Overview",10,t),t+=10,e.setFontSize(10);const s=`Total Unique Stocks: ${this.analysisReport.diversification.unique_stocks.count}`;e.text(s,15,t),t+=5,e.text(`Status: ${this.analysisReport.diversification.unique_stocks.status}`,15,t),t+=5,e.text(`Recommendation: ${this.analysisReport.diversification.unique_stocks.recommendation}`,15,t),t+=15,e.setFontSize(14),e.text("2. Sector Allocation",10,t),t+=10;const i=Object.entries(this.analysisReport.diversification.sector_breakdown).map(([u,w])=>[u,`${w.percentage.toFixed(1)}%`]).sort((u,w)=>parseFloat(w[1])-parseFloat(u[1]));e.autoTable({startY:t,head:[["Sector","Allocation"]],body:i,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:100},1:{cellWidth:40,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("3. Fund Category Distribution",10,t),t+=10;const r=Object.entries(this.analysisReport.diversification.category_breakdown).map(([u,w])=>[u,`${w.percentage.toFixed(1)}%`]).sort((u,w)=>parseFloat(w[1])-parseFloat(u[1]));e.autoTable({startY:t,head:[["Category","Allocation"]],body:r,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:100},1:{cellWidth:40,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("4. Stock Overlaps Analysis",10,t),t+=10;const d=this.formattedOverlaps.filter(u=>u.overlap_percentage>=25).sort((u,w)=>w.overlap_percentage-u.overlap_percentage),n=this.formattedOverlaps.map(u=>[u.fund1_name,u.fund2_name,`${u.overlap_percentage.toFixed(1)}%`]).sort((u,w)=>parseFloat(w[2])-parseFloat(u[2]));e.autoTable({startY:t,head:[["Fund 1","Fund 2","Overlap"]],body:n,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:70},1:{cellWidth:70},2:{cellWidth:30,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,d.length>0&&(e.setFontSize(10),e.text("High Overlap Warning:",15,t,{style:"bold"}),t+=5,e.text("The following fund pairs have significant overlap (>25%):",15,t),t+=5,d.forEach(u=>{const w=`• ${u.fund1_name} - ${u.fund2_name}: ${u.overlap_percentage.toFixed(1)}%`;e.text(w,20,t),t+=5})),t+=5,e.setFontSize(14),e.text("5. Expense Ratio Analysis",10,t),t+=10,console.log(this.analysisReport.expenses);const S=this.analysisReport.expenses.map(u=>[u.fund_name,`${u.expense_ratio.toFixed(2)}%`,`${u.category_avg.toFixed(2)}%`,`${u.relative_cost>0?"+":""}${u.relative_cost.toFixed(2)}%`]);e.autoTable({startY:t,head:[["Fund Name","Expense Ratio","Category Avg","Relative Cost"]],body:S,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:70},1:{cellWidth:40,halign:"right"},2:{cellWidth:40,halign:"right"},3:{cellWidth:40,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("6. Key Recommendations",10,t),t+=10,e.setFontSize(10),this.generateRecommendations().forEach(u=>{e.text(`• ${u}`,15,t),t+=5}),e.save("mutual_fund_analysis_report.pdf")}catch(e){console.error("Error generating PDF:",e)}finally{this.downloading=!1}},generateRecommendations(){var i,r;const e=[];this.analysisReport.overlaps.maxOverlap>25&&e.push(`Consider consolidating funds with high overlap (${(i=this.analysisReport.overlaps.maxOverlapPair)==null?void 0:i.fund1_name} and ${(r=this.analysisReport.overlaps.maxOverlapPair)==null?void 0:r.fund2_name})`);const{unique_stocks:t}=this.analysisReport.diversification;t.count>100?e.push("Portfolio may be over-diversified. Consider streamlining holdings."):t.count<30&&e.push("Portfolio concentration is high. Consider adding more diversity.");const s=this.analysisReport.expenses.filter(d=>d.relative_cost>.5);return s.length>0&&e.push(`Consider reviewing high expense funds: ${s.map(d=>d.fund_name).join(", ")}`),e}}},da={class:"analysis-container"},ca={class:"mt-2"};function ma(e,t,s,i,r,d){return D(),Q("div",da,[a(H,{class:"mb-4"},{default:l(()=>[a(q,{class:"d-flex flex-wrap"},{default:l(()=>[t[6]||(t[6]=p("span",{class:"text-h6"},"Stock Overlap Analysis",-1)),a(xe)]),_:1}),a(N,null,{default:l(()=>[a(he,{headers:e.overlapHeaders,items:d.formattedOverlaps,"items-per-page":5,density:"comfortable",class:"elevation-1",hover:!0},{"item.overlap_percentage":l(({item:n})=>[a(Z,{color:d.getOverlapColor(n.overlap_percentage),"text-color":"white"},{default:l(()=>[f(h(n.overlap_percentage)+"% ",1)]),_:2},1032,["color"])]),"item.actions":l(({item:n})=>[a(G,{small:"",text:"",color:"primary",onClick:S=>d.showOverlapDetails(n)},{default:l(()=>t[7]||(t[7]=[f(" Details ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1})]),_:1}),a(H,{class:"mb-4"},{default:l(()=>[a(q,{class:"text-h6"},{default:l(()=>t[8]||(t[8]=[f("Portfolio Diversification Analysis")])),_:1}),a(N,null,{default:l(()=>[a(be,{dense:""},{default:l(()=>[a(se,null,{default:l(()=>[a(H,{outlined:""},{default:l(()=>[a(q,{class:"text-subtitle-1"},{default:l(()=>[f(" Unique Stocks: "+h(s.analysisReport.diversification.unique_stocks.count),1)]),_:1}),a(N,null,{default:l(()=>[a(Z,{color:d.getDiversificationColor(s.analysisReport.diversification.unique_stocks.status),"text-color":"white"},{default:l(()=>[f(h(s.analysisReport.diversification.unique_stocks.status),1)]),_:1},8,["color"]),p("p",ca,h(s.analysisReport.diversification.unique_stocks.recommendation),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(be,null,{default:l(()=>[a(se,{cols:"12",sm:"6",md:"12",lg:"4"},{default:l(()=>[a(H,{outlined:""},{default:l(()=>[a(q,{class:"text-subtitle-1"},{default:l(()=>t[9]||(t[9]=[f("Fund Category Distribution")])),_:1}),a(N,null,{default:l(()=>[(D(!0),Q(U,null,fe(s.analysisReport.diversification.category_breakdown,(n,S)=>(D(),j(Ee,{key:S,value:n.percentage,color:d.getCategoryColor(S),height:"25",striped:""},{default:l(()=>[f(h(S)+": "+h(n.percentage)+"% ",1)]),_:2},1032,["value","color"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(H,null,{default:l(()=>[a(q,{class:"text-h6"},{default:l(()=>t[10]||(t[10]=[f("Expense Ratio Analysis")])),_:1}),a(N,null,{default:l(()=>[a(he,{headers:e.expenseHeaders,items:s.analysisReport.expenses,"items-per-page":5,density:"comfortable",hover:!0},{"item.relative_cost":l(({item:n})=>[a(Z,{color:d.getExpenseColor(n.relative_cost),"text-color":"white"},{default:l(()=>[f(h(n.relative_cost>0?"+":"")+h(n.relative_cost)+"% ",1)]),_:2},1032,["color"])]),_:1},8,["headers","items"])]),_:1})]),_:1}),a(H,{class:"mt-4"},{default:l(()=>[a(q,{class:"text-h6"},{default:l(()=>t[11]||(t[11]=[f("Similar ETFs")])),_:1}),a(N,null,{default:l(()=>[a(he,{headers:e.etfRecommendationHeaders,items:d.formattedEtfRecommendations,"items-per-page":5,density:"comfortable",hover:!0},{"item.overlap_percentage":l(({item:n})=>[f(h(n.overlap_percentage.toFixed(2))+"% ",1)]),"item.etf_fee":l(({item:n})=>[f(h(n.etf_fee.toFixed(2))+"% ",1)]),"item.fund_fee":l(({item:n})=>[f(h(n.fund_fee.toFixed(2))+"% ",1)]),"item.potential_savings":l(({item:n})=>[a(Z,{color:n.potential_savings>.3?"green":"orange","text-color":"white"},{default:l(()=>[f(h(n.potential_savings.toFixed(2))+"% ",1)]),_:2},1032,["color"])]),_:1},8,["headers","items"])]),_:1})]),_:1}),a(Ne,{modelValue:e.showDialog,"onUpdate:modelValue":t[3]||(t[3]=n=>e.showDialog=n),"max-width":"800px"},{default:l(()=>[a(H,null,{default:l(()=>[a(q,null,{default:l(()=>[t[13]||(t[13]=f(" Overlap Details ")),a(xe),a(G,{icon:"",onClick:t[0]||(t[0]=n=>e.showDialog=!1)},{default:l(()=>[a(re,null,{default:l(()=>t[12]||(t[12]=[f("mdi-close")])),_:1})]),_:1})]),_:1}),e.selectedOverlap?(D(),j(N,{key:0},{default:l(()=>[a(ra,{modelValue:e.activeTab,"onUpdate:modelValue":t[1]||(t[1]=n=>e.activeTab=n)},{default:l(()=>[a(_e,null,{default:l(()=>t[14]||(t[14]=[f("Overlapping Stocks")])),_:1}),a(_e,null,{default:l(()=>t[15]||(t[15]=[f("Unique Stocks")])),_:1}),a(_e,null,{default:l(()=>t[16]||(t[16]=[f("Fund Comparison")])),_:1})]),_:1},8,["modelValue"]),a(Ce,{modelValue:e.activeTab,"onUpdate:modelValue":t[2]||(t[2]=n=>e.activeTab=n)},{default:l(()=>[a(ve,null,{default:l(()=>[a(De,null,{default:l(()=>[p("thead",null,[p("tr",null,[t[17]||(t[17]=p("th",null,"Stock",-1)),p("th",null,h(e.selectedOverlap.comparison_metadata.fund1.name)+" (%) ",1),p("th",null,h(e.selectedOverlap.comparison_metadata.fund2.name)+" (%) ",1)])]),p("tbody",null,[(D(!0),Q(U,null,fe(e.selectedOverlap.overlapping_stocks,n=>(D(),Q("tr",{key:n.stock_name},[p("td",null,h(n.stock_name),1),p("td",null,h(n.fund1_holding),1),p("td",null,h(n.fund2_holding),1)]))),128))])]),_:1})]),_:1}),a(ve,null,{default:l(()=>[a(be,null,{default:l(()=>[a(se,{cols:"6"},{default:l(()=>[p("h3",null,h(e.selectedOverlap.comparison_metadata.fund1.name)+" Unique Stocks ",1),a(Fe,{dense:""},{default:l(()=>[(D(!0),Q(U,null,fe(e.selectedOverlap.fund1_unique_stocks,n=>(D(),j(ke,{key:n},{default:l(()=>[f(h(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),a(se,{cols:"6"},{default:l(()=>[p("h3",null,h(e.selectedOverlap.comparison_metadata.fund2.name)+" Unique Stocks ",1),a(Fe,{dense:""},{default:l(()=>[(D(!0),Q(U,null,fe(e.selectedOverlap.fund2_unique_stocks,n=>(D(),j(ke,{key:n},{default:l(()=>[f(h(n),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),a(ve,null,{default:l(()=>[a(De,null,{default:l(()=>[p("thead",null,[p("tr",null,[t[18]||(t[18]=p("th",null,"Metric",-1)),p("th",null,h(e.selectedOverlap.comparison_metadata.fund1.name),1),p("th",null,h(e.selectedOverlap.comparison_metadata.fund2.name),1)])]),p("tbody",null,[p("tr",null,[t[19]||(t[19]=p("td",null,"AUM (millions)",-1)),p("td",null,h(e.selectedOverlap.comparison_metadata.fund1.aum),1),p("td",null,h(e.selectedOverlap.comparison_metadata.fund2.aum),1)]),p("tr",null,[t[20]||(t[20]=p("td",null,"Star Rating",-1)),p("td",null,[a($e,{value:e.selectedOverlap.comparison_metadata.fund1.star_rating,readonly:"",small:"",dense:""},null,8,["value"])]),p("td",null,[a($e,{value:e.selectedOverlap.comparison_metadata.fund2.star_rating,readonly:"",small:"",dense:""},null,8,["value"])])]),p("tr",null,[t[21]||(t[21]=p("td",null,"Expense Ratio",-1)),p("td",null,h(e.selectedOverlap.comparison_metadata.fund1.expenses_ratio)+"% ",1),p("td",null,h(e.selectedOverlap.comparison_metadata.fund2.expenses_ratio)+"% ",1)])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):Te("",!0)]),_:1})]),_:1},8,["modelValue"]),a(Ne,{modelValue:e.showSectorDetails,"onUpdate:modelValue":t[5]||(t[5]=n=>e.showSectorDetails=n),"max-width":"800"},{default:l(()=>[a(H,null,{default:l(()=>[a(q,null,{default:l(()=>[t[23]||(t[23]=f(" Sector Analysis Details ")),a(xe),a(G,{icon:"",onClick:t[4]||(t[4]=n=>e.showSectorDetails=!1)},{default:l(()=>[a(re,null,{default:l(()=>t[22]||(t[22]=[f("mdi-close")])),_:1})]),_:1})]),_:1}),a(N,null,{default:l(()=>[a(he,{headers:d.sectorHeaders,items:d.sectorTableData,"items-per-page":10,class:"elevation-1"},{item:l(({item:n})=>[p("tr",null,[p("td",null,h(n.name),1),p("td",null,[a(Ee,{value:n.percentage,height:"20",color:"primary"},{default:l(()=>[f(h(n.percentage.toFixed(1))+"% ",1)]),_:2},1032,["value"])])])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Je=Ge(ua,[["render",ma],["__scopeId","data-v-df415bf6"]]);function fa(e,t,s){if(t==null)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return typeof t=="number"&&~t?a(U,null,[a("span",{class:"v-autocomplete__unmask"},[e.substr(0,t)]),a("span",{class:"v-autocomplete__mask"},[e.substr(t,s)]),a("span",{class:"v-autocomplete__unmask"},[e.substr(t+s)])]):e}const va=ue({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...ht({filterKeys:["title"]}),...yt(),...Re(bt({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),..._t({transition:!1})},"VAutocomplete"),pa=de()({name:"VAutocomplete",props:va(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:s}=t;const{t:i}=Ke(),r=oe(),d=ne(!1),n=ne(!0),S=ne(!1),b=oe(),u=oe(),w=ie(e,"menu"),v=P({get:()=>w.value,set:o=>{var g;w.value&&!o&&((g=b.value)!=null&&g.ΨopenChildren.size)||(w.value=o)}}),c=ne(-1),x=P(()=>{var o;return(o=r.value)==null?void 0:o.color}),M=P(()=>v.value?e.closeText:e.openText),{items:y,transformIn:C,transformOut:F}=kt(e),{textColorClasses:V,textColorStyles:L}=Ye(x),_=ie(e,"search",""),m=ie(e,"modelValue",[],o=>C(o===null?[null]:Jt(o)),o=>{const g=F(o);return e.multiple?g:g[0]??null}),$=P(()=>typeof e.counterValue=="function"?e.counterValue(m.value):typeof e.counterValue=="number"?e.counterValue:m.value.length),B=wt(e),{filteredItems:Y,getMatches:ee}=St(e,y,()=>n.value?"":_.value),I=P(()=>e.hideSelected?Y.value.filter(o=>!m.value.some(g=>g.value===o.value)):Y.value),te=P(()=>!!(e.chips||s.chip)),ae=P(()=>te.value||!!s.selection),we=P(()=>m.value.map(o=>o.props.value)),me=P(()=>{var g;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&_.value===((g=I.value[0])==null?void 0:g.title))&&I.value.length>0&&!n.value&&!S.value}),le=P(()=>e.hideNoData&&!I.value.length||B.isReadonly.value||B.isDisabled.value),Se=oe(),Xe=Vt(Se,r);function Qe(o){e.openOnClear&&(v.value=!0),_.value=""}function Ze(){le.value||(v.value=!0)}function et(o){le.value||(d.value&&(o.preventDefault(),o.stopPropagation()),v.value=!v.value)}function tt(o){var g;Kt(o)&&((g=r.value)==null||g.focus())}function at(o){var k,T,W;if(B.isReadonly.value)return;const g=r.value.selectionStart,R=m.value.length;if((c.value>-1||["Enter","ArrowDown","ArrowUp"].includes(o.key))&&o.preventDefault(),["Enter","ArrowDown"].includes(o.key)&&(v.value=!0),["Escape"].includes(o.key)&&(v.value=!1),me.value&&["Enter","Tab"].includes(o.key)&&!m.value.some(O=>{let{value:A}=O;return A===I.value[0].value})&&K(I.value[0]),o.key==="ArrowDown"&&me.value&&((k=Se.value)==null||k.focus("next")),["Backspace","Delete"].includes(o.key)){if(!e.multiple&&ae.value&&m.value.length>0&&!_.value)return K(m.value[0],!1);if(~c.value){const O=c.value;K(m.value[c.value],!1),c.value=O>=R-1?R-2:O}else o.key==="Backspace"&&!_.value&&(c.value=R-1)}if(e.multiple){if(o.key==="ArrowLeft"){if(c.value<0&&g>0)return;const O=c.value>-1?c.value-1:R-1;m.value[O]?c.value=O:(c.value=-1,r.value.setSelectionRange((T=_.value)==null?void 0:T.length,(W=_.value)==null?void 0:W.length))}if(o.key==="ArrowRight"){if(c.value<0)return;const O=c.value+1;m.value[O]?c.value=O:(c.value=-1,r.value.setSelectionRange(0,0))}}}function lt(o){if(ze(r.value,":autofill")||ze(r.value,":-webkit-autofill")){const g=y.value.find(R=>R.title===o.target.value);g&&K(g)}}function nt(){var o;e.eager&&((o=u.value)==null||o.calculateVisibleItems())}function st(){var o;d.value&&(n.value=!0,(o=r.value)==null||o.focus())}function ot(o){d.value=!0,setTimeout(()=>{S.value=!0})}function it(o){S.value=!1}function rt(o){(o==null||o===""&&!e.multiple&&!ae.value)&&(m.value=[])}const Ve=ne(!1);function K(o){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!o||o.props.disabled))if(e.multiple){const R=m.value.findIndex(T=>e.valueComparator(T.value,o.value)),k=g??!~R;if(~R){const T=k?[...m.value,o]:[...m.value];T.splice(R,1),m.value=T}else k&&(m.value=[...m.value,o]);e.clearOnSelect&&(_.value="")}else{const R=g!==!1;m.value=R?[o]:[],_.value=R&&!ae.value?o.title:"",Ue(()=>{v.value=!1,n.value=!0})}}return ye(d,(o,g)=>{var R;o!==g&&(o?(Ve.value=!0,_.value=e.multiple||ae.value?"":String(((R=m.value.at(-1))==null?void 0:R.props.title)??""),n.value=!0,Ue(()=>Ve.value=!1)):(!e.multiple&&_.value==null&&(m.value=[]),v.value=!1,m.value.some(k=>{let{title:T}=k;return T===_.value})||(_.value=""),c.value=-1))}),ye(_,o=>{!d.value||Ve.value||(o&&(v.value=!0),n.value=!o)}),ye(v,()=>{if(!e.hideSelected&&v.value&&m.value.length){const o=I.value.findIndex(g=>m.value.some(R=>g.value===R.value));Yt&&window.requestAnimationFrame(()=>{var g;o>=0&&((g=u.value)==null||g.scrollToIndex(o))})}}),ye(()=>e.items,(o,g)=>{v.value||d.value&&!g.length&&o.length&&(v.value=!0)}),ce(()=>{const o=!!(!e.hideNoData||I.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),g=m.value.length>0,R=Me.filterProps(e);return a(Me,E({ref:r},R,{modelValue:_.value,"onUpdate:modelValue":[k=>_.value=k,rt],focused:d.value,"onUpdate:focused":k=>d.value=k,validationValue:m.externalValue,counterValue:$.value,dirty:g,onChange:lt,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":v.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!ae.value,"v-autocomplete--selecting-index":c.value>-1},e.class],style:e.style,readonly:B.isReadonly.value,placeholder:g?void 0:e.placeholder,"onClick:clear":Qe,"onMousedown:control":Ze,onKeydown:at}),{...s,default:()=>a(U,null,[a(xt,E({ref:b,modelValue:v.value,"onUpdate:modelValue":k=>v.value=k,activator:"parent",contentClass:"v-autocomplete__content",disabled:le.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:nt,onAfterLeave:st},e.menuProps),{default:()=>[o&&a(Fe,E({ref:Se,selected:we.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:k=>k.preventDefault(),onKeydown:tt,onFocusin:ot,onFocusout:it,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},Xe,e.listProps),{default:()=>{var k,T,W;return[(k=s["prepend-item"])==null?void 0:k.call(s),!I.value.length&&!e.hideNoData&&(((T=s["no-data"])==null?void 0:T.call(s))??a(ke,{title:i(e.noDataText)},null)),a(Ct,{ref:u,renderless:!0,items:I.value},{default:O=>{var Ie;let{item:A,index:J,itemRef:z}=O;const Oe=E(A.props,{ref:z,key:J,active:me.value&&J===0?!0:void 0,onClick:()=>K(A,null)});return((Ie=s.item)==null?void 0:Ie.call(s,{item:A,index:J,props:Oe}))??a(ke,E(Oe,{role:"option"}),{prepend:pe=>{let{isSelected:ge}=pe;return a(U,null,[e.multiple&&!e.hideSelected?a(Ft,{key:A.value,modelValue:ge,ripple:!1,tabindex:"-1"},null):void 0,A.props.prependAvatar&&a(Tt,{image:A.props.prependAvatar},null),A.props.prependIcon&&a(re,{icon:A.props.prependIcon},null)])},title:()=>{var pe,ge;return n.value?A.title:fa(A.title,(pe=ee(A))==null?void 0:pe.title,((ge=_.value)==null?void 0:ge.length)??0)}})}}),(W=s["append-item"])==null?void 0:W.call(s)]}})]}),m.value.map((k,T)=>{function W(z){z.stopPropagation(),z.preventDefault(),K(k,!1)}const O={"onClick:close":W,onKeydown(z){z.key!=="Enter"&&z.key!==" "||(z.preventDefault(),z.stopPropagation(),W(z))},onMousedown(z){z.preventDefault(),z.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},A=te.value?!!s.chip:!!s.selection,J=A?jt(te.value?s.chip({item:k,index:T,props:O}):s.selection({item:k,index:T})):void 0;if(!(A&&!J))return a("div",{key:k.value,class:["v-autocomplete__selection",T===c.value&&["v-autocomplete__selection--selected",V.value]],style:T===c.value?L.value:{}},[te.value?s.chip?a(Rt,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:k.title}}},{default:()=>[J]}):a(Z,E({key:"chip",closable:e.closableChips,size:"small",text:k.title,disabled:k.props.disabled},O),null):J??a("span",{class:"v-autocomplete__selection-text"},[k.title,e.multiple&&T<m.value.length-1&&a("span",{class:"v-autocomplete__selection-comma"},[f(",")])])])})]),"append-inner":function(){var O;for(var k=arguments.length,T=new Array(k),W=0;W<k;W++)T[W]=arguments[W];return a(U,null,[(O=s["append-inner"])==null?void 0:O.call(s,...T),e.menuIcon?a(re,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:et,onClick:Gt,"aria-label":i(M.value),title:i(M.value),tabindex:"-1"},null):void 0])}})}),je({isFocused:d,isPristine:n,menu:v,search:_,filteredItems:Y,select:K},r)}}),ga={name:"ChatApp",components:{MutualFundAnalysis:Je,PromptChat:Pt},data(){return{messages:[],userInput:"",isLoading:!1,showError:!1,errorMessage:"",fundList:[],selectedFunds:[],portfolio:[],compareData:{},searchText:"",title:"Mutual Fund Helper Agent",subTitles:["Ask what Google/ChatGPT cant answer. E.g.","-किन म्यूचुअल फंडों में रिटर्न 20% से अधिक है, शुल्क 0.5% से कम है","-help me understand REITs and InvITs","Which stocks are present in only 2 small cap funds","** Trained on Indian data, can make mistakes"],userInputLabel:"This is an AI tool, double check responses.",debug:!1,systemPrompt:"mf_reasoning",analysisTypes:[{name:"Overlap Analysis",color:"primary",icon:"mdi-compare"},{name:"Diversification Analysis",color:"success",icon:"mdi-chart-pie"},{name:"Performance Compare",color:"info",icon:"mdi-chart-line"},{name:"Fee Compare",color:"warning",icon:"mdi-alert-circle-outline"}]}},computed:Ot(["loggedInGoogle","userGoogle"]),methods:{customFilter(e,t){const s=e.toLowerCase();return t.toLowerCase().split(/\s+/).every(d=>s.includes(d))},async fetchFundList(){try{const e=await Le.get("/api/mutualfunds/list");this.fundList=e.data.map(t=>{let s=t.return_3Y?" (3 Y Returns "+t.return_3Y+" %)":"";for(let i=1;i<=t.star_rating;i++)s+="⭐";return{name:t.name,displayName:t.name+s}})}catch(e){console.error("Error fetching fund list:",e)}},async sendCompare(){try{const e=await Le.post("/api/mutualfunds/compare",{fundList:this.selectedFunds});this.compareData=e.data}catch(e){console.error("Error in sendCompare:",e)}},handleSearch(e){this.searchText=e},handleFundSelection(e){this.portfolio.value=e.map(t=>({...this.fundList.find(i=>i.name===t),currentValue:"",investedDate:"",investedAmount:""}))},getSelectionHint(e){return""},async sendMessage(){var t;if(!this.userInput.trim())return;const e={role:"user",content:this.userInput.trim()};this.messages.push(e),this.userInput="",this.isLoading=!0;try{const i=(await fetch("/api/mutualfunds/chatStream",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify({messages:[...this.messages]})})).body.getReader(),r=new TextDecoder;let d="";for(;;){const{done:n,value:S}=await i.read();if(n)break;const u=r.decode(S).split(`
`);for(const w of u)if(w.startsWith("data: "))try{const v=JSON.parse(w.slice(5));if(v.error){this.showError=!0,this.errorMessage=v.error;break}if(d+=v.response,((t=this.messages[this.messages.length-1])==null?void 0:t.role)==="assistant"?this.messages[this.messages.length-1].content=d:this.messages.push({role:"assistant",content:d}),v.done)break}catch(v){console.error("Error parsing JSON:",v)}}}catch(s){console.error("Error:",s),this.errorMessage="Failed to get response from the assistant",this.showError=!0}finally{this.isLoading=!1,this.$nextTick(()=>{this.scrollToBottom()})}},scrollToBottom(){const e=this.$refs.messagesContainer;e&&(e.scrollTop=e.scrollHeight)}},async mounted(){console.log("mounted mutual fund"),this.fundList.length==0&&await this.fetchFundList()}};function ha(e,t,s,i,r,d){const n=Qt("prompt-chat"),S=Je;return D(),j(It,null,{default:l(()=>[a(At,{fluid:"",class:"fill-height pa-0"},{default:l(()=>[a(be,{"no-gutters":"",class:"fill-height"},{default:l(()=>[a(se,{cols:"12",md:"6",order:"first","order-md":"first",class:"left-panel"},{default:l(()=>[a(n,{systemPrompt:r.systemPrompt,title:r.title,subTitles:r.subTitles,userInputLabel:r.userInputLabel,debug:r.debug},null,8,["systemPrompt","title","subTitles","userInputLabel","debug"])]),_:1}),a(se,{cols:"12",md:"6",order:"last","order-md":"last",class:"right-panel"},{default:l(()=>[e.loggedInGoogle===!0?(D(),j(N,{key:0},{default:l(()=>[f("Welcome "+h(e.userGoogle.displayName),1)]),_:1})):Te("",!0),a(H,null,{default:l(()=>[a(q,null,{default:l(()=>t[4]||(t[4]=[f("Select 2 or More Funds")])),_:1}),a(Be,{class:"text-subtitle-2"},{default:l(()=>t[5]||(t[5]=[f(" Reduce Overlap ")])),_:1}),a(Be,{class:"text-subtitle-2"},{default:l(()=>t[6]||(t[6]=[f(" Fee of ETFs can be 10X lower than Mutual Funds. "),p("a",{href:"/etfList"},"See ETFs",-1)])),_:1}),a(N,{class:"pb-0"},{default:l(()=>[(D(!0),Q(U,null,fe(r.analysisTypes,b=>(D(),j(Z,{key:b.name,class:"me-2 mb-2",color:b.color,variant:"outlined"},{default:l(()=>[a(re,{start:""},{default:l(()=>[f(h(b.icon),1)]),_:2},1024),f(" "+h(b.name),1)]),_:2},1032,["color"]))),128))]),_:1}),a(N,null,{default:l(()=>[a(G,{disabled:r.selectedFunds.length<=1,onClick:t[0]||(t[0]=b=>d.sendCompare(r.selectedFunds)),color:"amber"},{default:l(()=>t[7]||(t[7]=[f("Compare")])),_:1},8,["disabled"]),a(pa,{modelValue:r.selectedFunds,"onUpdate:modelValue":[t[1]||(t[1]=b=>r.selectedFunds=b),d.handleFundSelection],items:r.fundList,"item-title":"displayName","custom-filter":d.customFilter,"item-value":"name",label:"Select Mutual Funds "+(r.selectedFunds.length?`(${r.selectedFunds.length} selected)`:""),multiple:"",chips:"","closable-chips":"","persistent-hint":"",hint:"Partial match works while typing e.g. 'Motilal Small'",search:r.searchText,"onUpdate:search":d.handleSearch},{chip:l(({props:b,item:u})=>[a(Z,E(b,{text:u.raw.name,variant:"elevated"}),{default:l(()=>[a(re,{start:""},{default:l(()=>t[8]||(t[8]=[f("mdi-chart-line")])),_:1}),f(" "+h(u.raw.name),1)]),_:2},1040,["text"])]),_:1},8,["modelValue","items","custom-filter","label","onUpdate:modelValue","search","onUpdate:search"])]),_:1}),r.compareData.overlaps?(D(),j(S,{key:0,analysisReport:r.compareData},null,8,["analysisReport"])):Te("",!0)]),_:1})]),_:1})]),_:1}),a(Zt,{modelValue:r.showError,"onUpdate:modelValue":t[3]||(t[3]=b=>r.showError=b),color:"error",timeout:"3000"},{action:l(({attrs:b})=>[a(G,E({text:""},b,{onClick:t[2]||(t[2]=u=>r.showError=!1)}),{default:l(()=>t[9]||(t[9]=[f(" Close ")])),_:2},1040)]),default:l(()=>[f(h(r.errorMessage)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})}const Va=Ge(ga,[["render",ha],["__scopeId","data-v-875d2f26"]]);export{Va as default};
//# sourceMappingURL=MutualFund-5x3EK4Ux.js.map
