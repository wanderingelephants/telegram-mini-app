import{M as V,I as v,D as S,G as E,V as M}from"./VAutocomplete-BPccTgqO.js";import{_ as I,Z as L,s as x,v as y,H as G,x as R,y as O,C as h,z as P,A as g,B as F,E as _,p as w,o as C,G as D,w as N}from"./index-B5pRQc6_.js";import{O as f,P as o,N as c,m as a,Q as l,V as m,_ as T,R as U,S as B,U as q,F as A,n as b}from"./vue-Ci2-vDhJ.js";import"./vuetify-BlS6c2-T.js";import"./VDialog-ydWOBKg_.js";const Y={name:"ChatApp",components:{MutualFundAnalysis:V,GoogleSignIn:L},data(){return{messages:[],userInput:"",isLoading:!1,showError:!1,errorMessage:"",fundList:[],selectedFunds:[],portfolio:[],compareData:{},searchText:"",title:"Mutual Fund Helper Agent",subTitles:["Ask what Google/ChatGPT cannot answer. E.g.","Find - किन म्यूचुअल फंडों में रिटर्न 20% से अधिक है, शुल्क 0.5% से कम है","Stock Discovery - Which stocks are present in only 1 small cap fund","Reasoning - Define Churn as stocks bought plus stocks sold in a fund. Which funds had highest churn","** Trained on Indian data, can make mistakes"],userInputLabel:"This is an AI tool. Double Check",debug:!1,distilledModel:"analysis_reasoning",analysisTypes:[{name:"Overlap",color:"primary",icon:"$mdiCompare"},{name:"Diversification",color:"success",icon:"$mdiChartPie"},{name:"Performance",color:"info",icon:"$mdiChartLine"},{name:"Fees",color:"warning",icon:"$mdiCurrencyRupee"}]}},watch:{async loggedInGoogle(s){},async userGoogle(s){s&&s.email&&(this.fundList.length===0&&await this.fetchFundList(),await this.getUserMFPortfolio())}},computed:x(["loggedInGoogle","userGoogle"]),methods:{customFilter(s,e){const n=s.toLowerCase();return e.toLowerCase().split(/\s+/).every(i=>n.includes(i))},async updatePortfolio(){const s=new Set(this.portfolio.map(t=>t.id)),e=this.selectedFunds,n=this.selectedFunds.filter(t=>!s.has(t)),u=this.portfolio.filter(t=>e.indexOf(t.id)==-1).map(t=>t.id);for(const[t,i]of n.entries())try{const d=await this.$apollo.query({query:v,variables:{object:{mutual_fund_id:i,user:{data:{email:this.userGoogle.email,google_id:this.userGoogle.uid},on_conflict:{constraint:"users_email_key",update_columns:["email"]}}}},fetchPolicy:"no-cache"})}catch(d){console.error(d)}for(const[t,i]of u.entries())try{const d=await this.$apollo.query({query:S,variables:{mutual_fund_id:i,email:this.userGoogle.email},fetchPolicy:"no-cache"})}catch(d){console.error(d)}},async getUserMFPortfolio(){if(this.userGoogle.email)try{const s=await this.$apollo.query({query:E,variables:{email:this.userGoogle.email}});this.selectedMFs=s.data.portfolio_mutual_funds.map(e=>{let n=e.mutual_fund.return_3Y?" (3 Y Returns "+e.mutual_fund.return_3Y+" %)":"";for(let u=1;u<=e.mutual_fund.star_rating;u++)n+="⭐";return{id:e.mutual_fund.id,name:e.mutual_fund.name,displayName:e.mutual_fund.name+n}}),this.selectedFunds=this.selectedMFs,this.portfolio=this.selectedMFs}catch(s){console.error(s)}},async fetchFundList(){try{const s=await y.get("/api/mutualfunds/list");this.fundList=s.data.map(e=>{let n=e.return_3Y?" (3 Y Returns "+e.return_3Y+" %)":"";for(let u=1;u<=e.star_rating;u++)n+="⭐";return{id:e.id,name:e.name,displayName:e.name+n}})}catch(s){console.error("Error fetching fund list:",s)}},async sendCompare(){console.log("this.selectedFunds",this.selectedFunds);const s=this.fundList.filter(e=>this.selectedFunds.indexOf(e.id)>-1).map(e=>e.name);console.log(s);try{const e=await y.post("/api/mutualfunds/analyze",{fundList:s});this.compareData=e.data}catch(e){console.error("Error in sendCompare:",e)}},handleSearch(s){this.searchText=s},scrollToBottom(){const s=this.$refs.messagesContainer;s&&(s.scrollTop=s.scrollHeight)}},async mounted(){this.fundList.length==0&&await this.fetchFundList()}};function W(s,e,n,u,t,i){const d=L,k=V;return c(),f(G,null,{default:o(()=>[a(N,{fluid:"",class:"fill-height pa-0"},{default:o(()=>[a(R,{"no-gutters":"",class:"fill-height"},{default:o(()=>[a(O,{cols:"12"},{default:o(()=>[a(d),s.loggedInGoogle===!0?(c(),f(h,{key:0},{default:o(()=>[l("Welcome "+m(s.userGoogle.displayName),1)]),_:1})):T("",!0),a(P,null,{default:o(()=>[a(g,null,{default:o(()=>e[4]||(e[4]=[l("We are NOT registered with SEBI.")])),_:1}),a(g,{class:"subtitle-wrap"},{default:o(()=>e[5]||(e[5]=[l("No Investment advice. Only providing DIY query tools.")])),_:1}),a(g,{class:"subtitle-wrap"},{default:o(()=>e[6]||(e[6]=[l("Select 2 or More Funds")])),_:1}),a(F,{class:"subtitle-wrap"},{default:o(()=>e[7]||(e[7]=[l(" Reduce Overlap ")])),_:1}),a(F,{class:"subtitle-wrap"},{default:o(()=>e[8]||(e[8]=[l(" Fee of ETFs can be 10X lower than Mutual Funds. "),U("a",{href:"/etfList"},"See ETFs",-1)])),_:1}),a(h,{class:"pb-0"},{default:o(()=>[(c(!0),B(A,null,q(t.analysisTypes,r=>(c(),f(w,{key:r.name,class:"me-2 mb-2",color:r.color,variant:"outlined"},{default:o(()=>[a(C,null,{default:o(()=>[l(m(r.icon),1)]),_:2},1024),l(" "+m(r.name),1)]),_:2},1032,["color"]))),128))]),_:1}),a(h,null,{default:o(()=>[a(_,{disabled:t.selectedFunds.length<=1,onClick:e[0]||(e[0]=r=>i.sendCompare(t.selectedFunds)),color:"amber"},{default:o(()=>e[9]||(e[9]=[l("Compare")])),_:1},8,["disabled"]),a(_,{onClick:i.updatePortfolio,class:"ml-2",color:"primary"},{default:o(()=>e[10]||(e[10]=[l("Update Portfolio")])),_:1},8,["onClick"]),a(M,{modelValue:t.selectedFunds,"onUpdate:modelValue":[e[1]||(e[1]=r=>t.selectedFunds=r),s.handleFundSelection],items:t.fundList,"item-title":"displayName","custom-filter":i.customFilter,"item-value":"id",label:"Select Mutual Funds "+(t.selectedFunds.length?`(${t.selectedFunds.length} selected)`:""),multiple:"",chips:"","closable-chips":"","persistent-hint":"",hint:"Partial match works while typing e.g. 'Motilal Small'",search:t.searchText,"onUpdate:search":i.handleSearch},{chip:o(({props:r,item:p})=>[a(w,b(r,{text:p.raw.name,variant:"elevated"}),{default:o(()=>[a(C,{start:""},{default:o(()=>e[11]||(e[11]=[l("$mdiChartLine")])),_:1}),l(" "+m(p.raw.name),1)]),_:2},1040,["text"])]),_:1},8,["modelValue","items","custom-filter","label","onUpdate:modelValue","search","onUpdate:search"])]),_:1}),t.compareData.overlaps?(c(),f(k,{key:0,analysisReport:t.compareData},null,8,["analysisReport"])):T("",!0)]),_:1})]),_:1})]),_:1}),a(D,{modelValue:t.showError,"onUpdate:modelValue":e[3]||(e[3]=r=>t.showError=r),color:"error",timeout:"3000"},{action:o(({attrs:r})=>[a(_,b({text:""},r,{onClick:e[2]||(e[2]=p=>t.showError=!1)}),{default:o(()=>e[12]||(e[12]=[l(" Close ")])),_:2},1040)]),default:o(()=>[l(m(t.errorMessage)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})}const Z=I(Y,[["render",W],["__scopeId","data-v-f2552774"]]);export{Z as default};
//# sourceMappingURL=MutualFund-C1vrr942.js.map
