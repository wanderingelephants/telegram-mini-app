import{ad as ee,ae as te,a5 as ae,p as q,_ as le,g as h,$ as A,i as b,Z as Y,l as z,f as k,d as w,e as S,L as j,n as ne,af as oe,ag as B,K,Q,S as J,o as re}from"./index-CtPf-Yqn.js";import{V as se,a as I}from"./VTabs-CXrymf2h.js";import{p as ie,J as Z,m as ue,b as de,g as me,W as ce,d as fe,B as pe,z as ge,ax as ve,E as _e,f as ye}from"./vuetify-CElno0QY.js";import{c as C,s as he,m as a,F as O,n as be,Q as d,N as v,S as R,P as l,R as r,V as s,U as E,O as P,$ as ke}from"./vue-DHJw1o5t.js";const Fe=ie({name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:Z,default:"$ratingEmpty"},fullIcon:{type:Z,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:[Number,String],default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},ripple:Boolean,...ue(),...ee(),...te(),...ae(),...de()},"VRating"),G=me()({name:"VRating",props:Fe(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const{t:y}=ce(),{themeClasses:F}=fe(e),u=pe(e,"modelValue"),n=C(()=>ge(parseFloat(u.value),0,+e.length)),_=C(()=>ve(Number(e.length),1)),L=C(()=>_.value.flatMap(m=>e.halfIncrements?[m-.5,m]:[m])),o=he(-1),c=C(()=>L.value.map(m=>{const p=e.hover&&o.value>-1,f=n.value>=m,g=o.value>=m,x=(p?g:f)?e.fullIcon:e.emptyIcon,$=e.activeColor??e.color,T=f||g?$:e.color;return{isFilled:f,isHovered:g,icon:x,color:T}})),X=C(()=>[0,...L.value].map(m=>{function p(){o.value=m}function f(){o.value=-1}function g(){e.disabled||e.readonly||(u.value=n.value===m&&e.clearable?0:m)}return{onMouseenter:e.hover?p:void 0,onMouseleave:e.hover?f:void 0,onClick:g}})),M=C(()=>e.name??`v-rating-${_e()}`);function D(m){var H,U;let{value:p,index:f,showStar:g=!0}=m;const{onMouseenter:V,onMouseleave:x,onClick:$}=X.value[f+1],T=`${M.value}-${String(p).replace(".","-")}`,N={color:(H=c.value[f])==null?void 0:H.color,density:e.density,disabled:e.disabled,icon:(U=c.value[f])==null?void 0:U.icon,ripple:e.ripple,size:e.size,variant:"plain"};return a(O,null,[a("label",{for:T,class:{"v-rating__item--half":e.halfIncrements&&p%1>0,"v-rating__item--full":e.halfIncrements&&p%1===0},onMouseenter:V,onMouseleave:x,onClick:$},[a("span",{class:"v-rating__hidden"},[y(e.itemAriaLabel,p,e.length)]),g?i.item?i.item({...c.value[f],props:N,value:p,index:f,rating:n.value}):a(q,be({"aria-label":y(e.itemAriaLabel,p,e.length)},N),null):void 0]),a("input",{class:"v-rating__hidden",name:M.value,id:T,type:"radio",value:p,checked:n.value===p,tabindex:-1,readonly:e.readonly,disabled:e.disabled},null)])}function W(m){return i["item-label"]?i["item-label"](m):m.label?a("span",null,[m.label]):a("span",null,[d(" ")])}return ye(()=>{var p;const m=!!((p=e.itemLabels)!=null&&p.length)||i["item-label"];return a(e.tag,{class:["v-rating",{"v-rating--hover":e.hover,"v-rating--readonly":e.readonly},F.value,e.class],style:e.style},{default:()=>[a(D,{value:0,index:-1,showStar:!1},null),_.value.map((f,g)=>{var V,x;return a("div",{class:"v-rating__wrapper"},[m&&e.itemLabelPosition==="top"?W({value:f,index:g,label:(V=e.itemLabels)==null?void 0:V[g]}):void 0,a("div",{class:"v-rating__item"},[e.halfIncrements?a(O,null,[a(D,{value:f-.5,index:g*2},null),a(D,{value:f,index:g*2+1},null)]):a(D,{value:f,index:g},null)]),m&&e.itemLabelPosition==="bottom"?W({value:f,index:g,label:(x=e.itemLabels)==null?void 0:x[g]}):void 0])})]})}),{}}}),xe={name:"MFAnalysis",components:{},props:{analysisReport:{type:Object,required:!0}},data:()=>({showDialog:!1,showSectorDetails:!1,selectedOverlap:null,activeTab:0,downloading:!1,overlapHeaders:[{title:"Fund 1",key:"fund1_name"},{title:"Fund 2",key:"fund2_name"},{title:"Overlap %",key:"overlap_percentage"},{title:"Actions",key:"actions",sortable:!1}],expenseHeaders:[{title:"Fund Name",key:"fund_name"},{title:"Expense Ratio",key:"expense_ratio"},{title:"Category Average",key:"category_avg"},{title:"Relative Cost",key:"relative_cost"}],etfRecommendationHeaders:[{title:"Fund Name",key:"fund_name"},{title:"ETF Name",key:"etf"},{title:"Overlap %",key:"overlap_percentage"},{title:"ETF Fee %",key:"etf_fee"},{title:"Fund Fee %",key:"fund_fee"},{title:"Potential Savings %",key:"potential_savings"}]}),computed:{sectorChartSeries(){return Object.values(this.analysisReport.diversification.sector_breakdown).map(e=>e.percentage)},sectorChartOptions(){return{chart:{type:"donut",animations:{dynamicAnimation:{enabled:!0}}},labels:Object.keys(this.analysisReport.diversification.sector_breakdown),plotOptions:{pie:{donut:{size:"65%"}}},tooltip:{y:{formatter:e=>`${e.toFixed(1)}%`}},legend:{position:"bottom",horizontalAlign:"center",fontSize:"14px",markers:{width:12,height:12,radius:12}},responsive:[{breakpoint:480,options:{chart:{width:300},legend:{position:"bottom"}}}],dataLabels:{enabled:!1},colors:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0","#3F51B5","#546E7A","#D4526E","#8D5B4C","#F86624","#D7263D","#1B998B","#2E294E","#F46036","#E2C044"]}},sectorTableData(){const e=this.analysisReport.diversification.sector_breakdown;return Object.entries(e).map(([t,i])=>({name:t,percentage:i.percentage})).sort((t,i)=>i.percentage-t.percentage)},sectorHeaders(){return[{title:"Sector",key:"name"},{title:"Allocation (%)",key:"percentage"}]},performanceHeaders(){return[{title:"Fund Name",key:"mutual_fund_name",align:"start",sortable:!0},{title:"5 Year",key:"mutual_fund_return_5Y",align:"end",sortable:!0,format:e=>`${e}%`},{title:"3 Year",key:"mutual_fund_return_3Y",align:"end",sortable:!0,format:e=>`${e}%`},{title:"1 Year",key:"mutual_fund_return_1Y",align:"end",sortable:!0,format:e=>`${e}%`}]},performanceTableData(){const e=this.analysisReport.performanceAnalysis;return console.log("flattened",e.map(t=>({mutual_fund_name:t.mutual_fund_name,mutual_fund_return_1Y:t.mutual_fund_return_1Y||"-",mutual_fund_return_3Y:t.mutual_fund_return_3Y||"-",mutual_fund_return_5Y:t.mutual_fund_return_5Y||"-"}))),e.map(t=>({mutual_fund_name:t.mutual_fund_name,mutual_fund_return_1Y:t.mutual_fund_return_1Y||"-",mutual_fund_return_3Y:t.mutual_fund_return_3Y||"-",mutual_fund_return_5Y:t.mutual_fund_return_5Y||"-"}))},formattedOverlaps(){return this.analysisReport.overlaps.overlaps.map(e=>({fund1_name:e.comparison_metadata.fund1.name,fund2_name:e.comparison_metadata.fund2.name,overlap_percentage:e.overlap_percentage,...e})).sort((e,t)=>t.overlap_percentage-e.overlap_percentage)}},methods:{getOverlapColor(e){return e>=25?"red":e>=15?"orange":"green"},getDiversificationColor(e){return{"over-diversified":"orange",concentrated:"red",optimal:"green"}[e]||"grey"},getCategoryColor(e){return{"large cap":"blue","mid cap":"purple","small cap":"deep-purple","multi cap":"indigo"}[e.toLowerCase()]||"grey"},getExpenseColor(e){return e>.5?"red":e<-.5?"green":"orange"},showOverlapDetails(e){this.selectedOverlap=e,this.showDialog=!0},async downloadCompleteReport(){this.downloading=!0;try{const e=new jsPDF("p","mm","a4");let t=10;e.setFontSize(18),e.text("Mutual Fund Analysis Report",105,t,{align:"center"}),t+=15,e.setFontSize(14),e.text("1. Portfolio Overview",10,t),t+=10,e.setFontSize(10);const i=`Total Unique Stocks: ${this.analysisReport.diversification.unique_stocks.count}`;e.text(i,15,t),t+=5,e.text(`Status: ${this.analysisReport.diversification.unique_stocks.status}`,15,t),t+=5,e.text(`Recommendation: ${this.analysisReport.diversification.unique_stocks.recommendation}`,15,t),t+=15,e.setFontSize(14),e.text("2. Sector Allocation",10,t),t+=10;const y=Object.entries(this.analysisReport.diversification.sector_breakdown).map(([o,c])=>[o,`${c.percentage.toFixed(1)}%`]).sort((o,c)=>parseFloat(c[1])-parseFloat(o[1]));e.autoTable({startY:t,head:[["Sector","Allocation"]],body:y,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:100},1:{cellWidth:40,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("3. Fund Category Distribution",10,t),t+=10;const F=Object.entries(this.analysisReport.diversification.category_breakdown).map(([o,c])=>[o,`${c.percentage.toFixed(1)}%`]).sort((o,c)=>parseFloat(c[1])-parseFloat(o[1]));e.autoTable({startY:t,head:[["Category","Allocation"]],body:F,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:100},1:{cellWidth:40,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("4. Stock Overlaps Analysis",10,t),t+=10;const u=this.formattedOverlaps.filter(o=>o.overlap_percentage>=25).sort((o,c)=>c.overlap_percentage-o.overlap_percentage),n=this.formattedOverlaps.map(o=>[o.fund1_name,o.fund2_name,`${o.overlap_percentage.toFixed(1)}%`]).sort((o,c)=>parseFloat(c[2])-parseFloat(o[2]));e.autoTable({startY:t,head:[["Fund 1","Fund 2","Overlap"]],body:n,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:70},1:{cellWidth:70},2:{cellWidth:30,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,u.length>0&&(e.setFontSize(10),e.text("High Overlap Warning:",15,t,{style:"bold"}),t+=5,e.text("The following fund pairs have significant overlap (>25%):",15,t),t+=5,u.forEach(o=>{const c=`• ${o.fund1_name} - ${o.fund2_name}: ${o.overlap_percentage.toFixed(1)}%`;e.text(c,20,t),t+=5})),t+=5,e.setFontSize(14),e.text("5. Expense Ratio Analysis",10,t),t+=10,console.log(this.analysisReport.expenses);const _=this.analysisReport.expenses.map(o=>[o.fund_name,`${o.expense_ratio.toFixed(2)}%`,`${o.category_avg.toFixed(2)}%`,`${o.relative_cost>0?"+":""}${o.relative_cost.toFixed(2)}%`]);e.autoTable({startY:t,head:[["Fund Name","Expense Ratio","Category Avg","Relative Cost"]],body:_,theme:"striped",headStyles:{fillColor:[71,85,119]},columnStyles:{0:{cellWidth:70},1:{cellWidth:40,halign:"right"},2:{cellWidth:40,halign:"right"},3:{cellWidth:40,halign:"right"}},margin:{left:15}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("6. Key Recommendations",10,t),t+=10,e.setFontSize(10),this.generateRecommendations().forEach(o=>{e.text(`• ${o}`,15,t),t+=5}),e.save("mutual_fund_analysis_report.pdf")}catch(e){console.error("Error generating PDF:",e)}finally{this.downloading=!1}},generateRecommendations(){var y,F;const e=[];this.analysisReport.overlaps.maxOverlap>25&&e.push(`Consider consolidating funds with high overlap (${(y=this.analysisReport.overlaps.maxOverlapPair)==null?void 0:y.fund1_name} and ${(F=this.analysisReport.overlaps.maxOverlapPair)==null?void 0:F.fund2_name})`);const{unique_stocks:t}=this.analysisReport.diversification;t.count>100?e.push("Portfolio may be over-diversified. Consider streamlining holdings."):t.count<30&&e.push("Portfolio concentration is high. Consider adding more diversity.");const i=this.analysisReport.expenses.filter(u=>u.relative_cost>.5);return i.length>0&&e.push(`Consider reviewing high expense funds: ${i.map(u=>u.fund_name).join(", ")}`),e}}},Se={class:"analysis-container"},Ce={class:"mt-2"};function Re(e,t,i,y,F,u){return v(),R("div",Se,[a(k,{class:"mb-4"},{default:l(()=>[a(h,{class:"d-flex flex-wrap"},{default:l(()=>[t[4]||(t[4]=r("span",{class:"text-h6"},"Stock Overlap Analysis",-1)),a(A)]),_:1}),a(b,null,{default:l(()=>[a(Y,{headers:e.overlapHeaders,items:u.formattedOverlaps,"items-per-page":5,density:"comfortable",class:"elevation-1",hover:!0},{"item.overlap_percentage":l(({item:n})=>[a(z,{color:u.getOverlapColor(n.overlap_percentage),"text-color":"white"},{default:l(()=>[d(s(n.overlap_percentage)+"% ",1)]),_:2},1032,["color"])]),"item.actions":l(({item:n})=>[a(q,{small:"",text:"",color:"primary",onClick:_=>u.showOverlapDetails(n)},{default:l(()=>t[5]||(t[5]=[d(" Details ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1})]),_:1}),a(k,{class:"mb-4"},{default:l(()=>[a(h,{class:"text-h6"},{default:l(()=>t[6]||(t[6]=[d("Portfolio Diversification Analysis")])),_:1}),a(b,null,{default:l(()=>[a(w,{dense:""},{default:l(()=>[a(S,null,{default:l(()=>[a(k,{outlined:""},{default:l(()=>[a(h,{class:"text-subtitle-1"},{default:l(()=>[d(" Unique Stocks: "+s(i.analysisReport.diversification.unique_stocks.count),1)]),_:1}),a(b,null,{default:l(()=>[a(z,{color:u.getDiversificationColor(i.analysisReport.diversification.unique_stocks.status),"text-color":"white"},{default:l(()=>[d(s(i.analysisReport.diversification.unique_stocks.status),1)]),_:1},8,["color"]),r("p",Ce,s(i.analysisReport.diversification.unique_stocks.recommendation),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(w,null,{default:l(()=>[a(S,null,{default:l(()=>[a(k,null,{default:l(()=>[a(h,null,{default:l(()=>[t[7]||(t[7]=d(" Sector Analysis Details ")),a(A)]),_:1}),a(b,null,{default:l(()=>[a(Y,{headers:u.sectorHeaders,items:u.sectorTableData,"items-per-page":5,density:"comfortable",class:"elevation-1"},{item:l(({item:n})=>[r("tr",null,[r("td",null,s(n.name),1),r("td",null,[a(j,{value:n.percentage,height:"20",color:"primary"},{default:l(()=>[d(s(n.percentage.toFixed(1))+"% ",1)]),_:2},1032,["value"])])])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1})]),_:1}),a(w,null,{default:l(()=>[a(S,null,{default:l(()=>[a(k,null,{default:l(()=>[a(h,null,{default:l(()=>[t[8]||(t[8]=d(" Performance Analysis (Returns) ")),a(A)]),_:1}),a(b,null,{default:l(()=>[a(Y,{headers:u.performanceHeaders,items:u.performanceTableData,"items-per-page":5,density:"comfortable",class:"elevation-1"},null,8,["headers","items"])]),_:1})]),_:1})]),_:1})]),_:1}),a(w,null,{default:l(()=>[a(S,{cols:"12",sm:"6",md:"12",lg:"12"},{default:l(()=>[a(k,{outlined:""},{default:l(()=>[a(h,{class:"text-subtitle-1"},{default:l(()=>t[9]||(t[9]=[d("Fund Category Distribution")])),_:1}),a(b,null,{default:l(()=>[(v(!0),R(O,null,E(i.analysisReport.diversification.category_breakdown,(n,_)=>(v(),P(j,{key:_,value:n.percentage,color:u.getCategoryColor(_),height:"25",striped:""},{default:l(()=>[d(s(_)+": "+s(n.percentage)+"% ",1)]),_:2},1032,["value","color"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(k,null,{default:l(()=>[a(h,{class:"text-h6"},{default:l(()=>t[10]||(t[10]=[d("Expense Ratio Analysis")])),_:1}),a(b,null,{default:l(()=>[a(Y,{headers:e.expenseHeaders,items:i.analysisReport.expenses,"items-per-page":5,density:"comfortable",hover:!0},{"item.relative_cost":l(({item:n})=>[a(z,{color:u.getExpenseColor(n.relative_cost),"text-color":"white"},{default:l(()=>[d(s(n.relative_cost>0?"+":"")+s(n.relative_cost)+"% ",1)]),_:2},1032,["color"])]),_:1},8,["headers","items"])]),_:1})]),_:1}),a(re,{modelValue:e.showDialog,"onUpdate:modelValue":t[3]||(t[3]=n=>e.showDialog=n),"max-width":"800px"},{default:l(()=>[a(k,null,{default:l(()=>[a(h,null,{default:l(()=>[t[12]||(t[12]=d(" Overlap Details ")),a(A),a(q,{icon:"",onClick:t[0]||(t[0]=n=>e.showDialog=!1)},{default:l(()=>[a(ne,null,{default:l(()=>t[11]||(t[11]=[d("$mdiClose")])),_:1})]),_:1})]),_:1}),e.selectedOverlap?(v(),P(b,{key:0},{default:l(()=>[a(se,{modelValue:e.activeTab,"onUpdate:modelValue":t[1]||(t[1]=n=>e.activeTab=n)},{default:l(()=>[a(I,null,{default:l(()=>t[13]||(t[13]=[d("Overlapping Stocks")])),_:1}),a(I,null,{default:l(()=>t[14]||(t[14]=[d("Unique Stocks")])),_:1}),a(I,null,{default:l(()=>t[15]||(t[15]=[d("Fund Comparison")])),_:1})]),_:1},8,["modelValue"]),a(oe,{modelValue:e.activeTab,"onUpdate:modelValue":t[2]||(t[2]=n=>e.activeTab=n)},{default:l(()=>[a(B,null,{default:l(()=>[a(K,null,{default:l(()=>[r("thead",null,[r("tr",null,[t[16]||(t[16]=r("th",null,"Stock",-1)),r("th",null,s(e.selectedOverlap.comparison_metadata.fund1.name)+" (%) ",1),r("th",null,s(e.selectedOverlap.comparison_metadata.fund2.name)+" (%) ",1)])]),r("tbody",null,[(v(!0),R(O,null,E(e.selectedOverlap.overlapping_stocks,n=>(v(),R("tr",{key:n.stock_name},[r("td",null,s(n.stock_name),1),r("td",null,s(n.fund1_holding),1),r("td",null,s(n.fund2_holding),1)]))),128))])]),_:1})]),_:1}),a(B,null,{default:l(()=>[a(w,null,{default:l(()=>[a(S,{cols:"6"},{default:l(()=>[r("h3",null,s(e.selectedOverlap.comparison_metadata.fund1.name)+" Unique Stocks ",1),a(Q,{dense:""},{default:l(()=>[(v(!0),R(O,null,E(e.selectedOverlap.fund1_unique_stocks,n=>(v(),P(J,{key:n},{default:l(()=>[d(s(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),a(S,{cols:"6"},{default:l(()=>[r("h3",null,s(e.selectedOverlap.comparison_metadata.fund2.name)+" Unique Stocks ",1),a(Q,{dense:""},{default:l(()=>[(v(!0),R(O,null,E(e.selectedOverlap.fund2_unique_stocks,n=>(v(),P(J,{key:n},{default:l(()=>[d(s(n),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),a(B,null,{default:l(()=>[a(K,null,{default:l(()=>[r("thead",null,[r("tr",null,[t[17]||(t[17]=r("th",null,"Metric",-1)),r("th",null,s(e.selectedOverlap.comparison_metadata.fund1.name),1),r("th",null,s(e.selectedOverlap.comparison_metadata.fund2.name),1)])]),r("tbody",null,[r("tr",null,[t[18]||(t[18]=r("td",null,"AUM (millions)",-1)),r("td",null,s(e.selectedOverlap.comparison_metadata.fund1.aum),1),r("td",null,s(e.selectedOverlap.comparison_metadata.fund2.aum),1)]),r("tr",null,[t[19]||(t[19]=r("td",null,"Star Rating",-1)),r("td",null,[a(G,{value:e.selectedOverlap.comparison_metadata.fund1.star_rating,readonly:"",small:"",dense:""},null,8,["value"])]),r("td",null,[a(G,{value:e.selectedOverlap.comparison_metadata.fund2.star_rating,readonly:"",small:"",dense:""},null,8,["value"])])]),r("tr",null,[t[20]||(t[20]=r("td",null,"Expense Ratio",-1)),r("td",null,s(e.selectedOverlap.comparison_metadata.fund1.expenses_ratio)+"% ",1),r("td",null,s(e.selectedOverlap.comparison_metadata.fund2.expenses_ratio)+"% ",1)])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):ke("",!0)]),_:1})]),_:1},8,["modelValue"])])}const Te=le(xe,[["render",Re],["__scopeId","data-v-f8a46b76"]]);export{Te as M};
//# sourceMappingURL=MutualFundAnalysis-DtuGRrgN.js.map
