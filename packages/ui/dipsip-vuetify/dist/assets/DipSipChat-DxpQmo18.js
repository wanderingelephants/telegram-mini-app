import{_ as ke,m as Oe,a as je,b as ze,c as He,u as Ke,d as qe,e as We,t as R,f as Qe,g as Ye,V as me,h as Ze,i as Je,j as ve,k as Xe,l as $e,n as et,o as ge,p as tt,q as lt,r as at,P as nt,s as st,v as H,w as ot,x as L,y as T,z as K,A as q,B as it,C as N,D as he,E as ne,F as se,G as ut}from"./index-qidaSccv.js";import{N as F,S as ie,d as W,s as B,c as w,w as U,A as be,m as a,F as Z,n as E,Q as b,O as oe,P as i,R as V,Z as rt,_ as Q,V as Y,$ as ct}from"./vue-BQEgaIvT.js";import{p as dt,a0 as ft,g as mt,W as vt,B as pe,O as gt,f as ht,av as bt,aG as pt,aw as yt,aH as kt,G as Ct}from"./vuetify-BbdkIOBN.js";import{V as ye}from"./VDialog-DyO7FhE3.js";import{V as wt}from"./VSnackbar-CaqblNDM.js";const Vt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_GRAPHQL_ENDPOINT:"https://dipsip.co.in",VITE_GRAPHQL_SOCKET_ENDPOINT:"wss://dipsip.co.in"},xt={name:"TelegramLogin",props:{botName:{type:String,required:!0}},mounted(){const e=document.createElement("script");e.src="https://telegram.org/js/telegram-widget.js?22",e.async=!0,console.log("TG",Vt),console.log("data-telegram-login",this.botName),e.setAttribute("data-telegram-login","DipSipBot"),e.setAttribute("data-size","large"),e.setAttribute("data-onauth","onTelegramAuth(user)"),e.setAttribute("data-request-access","write"),this.$refs.telegramLoginBtn.appendChild(e),window.onTelegramAuth=l=>{this.$emit("telegram-auth",l)}}},St={ref:"telegramLoginBtn"};function _t(e,l,S,r,n,m){return F(),ie("div",St,null,512)}const Dt=ke(xt,[["render",_t]]);function Pt(e,l,S){if(l==null)return e;if(Array.isArray(l))throw new Error("Multiple matches is not implemented");return typeof l=="number"&&~l?a(Z,null,[a("span",{class:"v-combobox__unmask"},[e.substr(0,l)]),a("span",{class:"v-combobox__mask"},[e.substr(l,S)]),a("span",{class:"v-combobox__unmask"},[e.substr(l+S)])]):e}const At=dt({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Oe({filterKeys:["title"]}),...je({hideNoData:!0,returnObject:!0}),...ft(ze({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...He({transition:!1})},"VCombobox"),It=mt()({name:"VCombobox",props:At(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,l){var ce;let{emit:S,slots:r}=l;const{t:n}=vt(),m=W(),y=B(!1),u=B(!0),J=B(!1),ue=W(),X=W(),$=pe(e,"menu"),g=w({get:()=>$.value,set:t=>{var s;$.value&&!t&&((s=ue.value)!=null&&s.Î¨openChildren.size)||($.value=t)}}),f=B(-1);let ee=!1;const Ce=w(()=>{var t;return(t=m.value)==null?void 0:t.color}),re=w(()=>g.value?e.closeText:e.openText),{items:we,transformIn:Ve,transformOut:xe}=Ke(e),{textColorClasses:Se,textColorStyles:_e}=qe(Ce),c=pe(e,"modelValue",[],t=>Ve(Ct(t)),t=>{const s=xe(t);return e.multiple?s:s[0]??null}),G=We(e),M=w(()=>!!(e.chips||r.chip)),_=w(()=>M.value||!!r.selection),D=B(!e.multiple&&!_.value?((ce=c.value[0])==null?void 0:ce.title)??"":""),h=w({get:()=>D.value,set:t=>{var s;if(D.value=t??"",!e.multiple&&!_.value&&(c.value=[R(e,t)]),t&&e.multiple&&((s=e.delimiters)!=null&&s.length)){const v=t.split(new RegExp(`(?:${e.delimiters.join("|")})+`));v.length>1&&(v.forEach(o=>{o=o.trim(),o&&x(R(e,o))}),D.value="")}t||(f.value=-1),u.value=!t}}),De=w(()=>typeof e.counterValue=="function"?e.counterValue(c.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?c.value.length:h.value.length);U(D,t=>{ee?be(()=>ee=!1):y.value&&!g.value&&(g.value=!0),S("update:search",t)}),U(c,t=>{var s;!e.multiple&&!_.value&&(D.value=((s=t[0])==null?void 0:s.title)??"")});const{filteredItems:O,getMatches:Pe}=Qe(e,we,()=>u.value?"":h.value),P=w(()=>e.hideSelected?O.value.filter(t=>!c.value.some(s=>s.value===t.value)):O.value),Ae=w(()=>c.value.map(t=>t.value)),te=w(()=>{var s;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&h.value===((s=P.value[0])==null?void 0:s.title))&&P.value.length>0&&!u.value&&!J.value}),le=w(()=>e.hideNoData&&!P.value.length||G.isReadonly.value||G.isDisabled.value),ae=W(),Ie=Ye(ae,m);function Te(t){ee=!0,e.openOnClear&&(g.value=!0)}function Ee(){le.value||(g.value=!0)}function Fe(t){le.value||(y.value&&(t.preventDefault(),t.stopPropagation()),g.value=!g.value)}function Re(t){var s;yt(t)&&((s=m.value)==null||s.focus())}function Le(t){var o;if(kt(t)||G.isReadonly.value)return;const s=m.value.selectionStart,v=c.value.length;if((f.value>-1||["Enter","ArrowDown","ArrowUp"].includes(t.key))&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(g.value=!0),["Escape"].includes(t.key)&&(g.value=!1),["Enter","Escape","Tab"].includes(t.key)&&(te.value&&["Enter","Tab"].includes(t.key)&&!c.value.some(d=>{let{value:C}=d;return C===P.value[0].value})&&x(O.value[0]),u.value=!0),t.key==="ArrowDown"&&te.value&&((o=ae.value)==null||o.focus("next")),t.key==="Enter"&&h.value&&(x(R(e,h.value)),_.value&&(D.value="")),["Backspace","Delete"].includes(t.key)){if(!e.multiple&&_.value&&c.value.length>0&&!h.value)return x(c.value[0],!1);if(~f.value){const d=f.value;x(c.value[f.value],!1),f.value=d>=v-1?v-2:d}else t.key==="Backspace"&&!h.value&&(f.value=v-1)}if(e.multiple){if(t.key==="ArrowLeft"){if(f.value<0&&s>0)return;const d=f.value>-1?f.value-1:v-1;c.value[d]?f.value=d:(f.value=-1,m.value.setSelectionRange(h.value.length,h.value.length))}if(t.key==="ArrowRight"){if(f.value<0)return;const d=f.value+1;c.value[d]?f.value=d:(f.value=-1,m.value.setSelectionRange(0,0))}}}function Ne(){var t;e.eager&&((t=X.value)==null||t.calculateVisibleItems())}function Be(){var t;y.value&&(u.value=!0,(t=m.value)==null||t.focus())}function x(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!t||t.props.disabled))if(e.multiple){const v=c.value.findIndex(d=>e.valueComparator(d.value,t.value)),o=s??!~v;if(~v){const d=o?[...c.value,t]:[...c.value];d.splice(v,1),c.value=d}else o&&(c.value=[...c.value,t]);e.clearOnSelect&&(h.value="")}else{const v=s!==!1;c.value=v?[t]:[],D.value=v&&!_.value?t.title:"",be(()=>{g.value=!1,u.value=!0})}}function Ue(t){y.value=!0,setTimeout(()=>{J.value=!0})}function Ge(t){J.value=!1}function Me(t){(t==null||t===""&&!e.multiple&&!_.value)&&(c.value=[])}return U(y,(t,s)=>{if(!(t||t===s)&&(f.value=-1,g.value=!1,h.value)){if(e.multiple){x(R(e,h.value));return}if(!_.value)return;c.value.some(v=>{let{title:o}=v;return o===h.value})?D.value="":x(R(e,h.value))}}),U(g,()=>{if(!e.hideSelected&&g.value&&c.value.length){const t=P.value.findIndex(s=>c.value.some(v=>e.valueComparator(v.value,s.value)));gt&&window.requestAnimationFrame(()=>{var s;t>=0&&((s=X.value)==null||s.scrollToIndex(t))})}}),U(()=>e.items,(t,s)=>{g.value||y.value&&!s.length&&t.length&&(g.value=!0)}),ht(()=>{const t=!!(!e.hideNoData||P.value.length||r["prepend-item"]||r["append-item"]||r["no-data"]),s=c.value.length>0,v=me.filterProps(e);return a(me,E({ref:m},v,{modelValue:h.value,"onUpdate:modelValue":[o=>h.value=o,Me],focused:y.value,"onUpdate:focused":o=>y.value=o,validationValue:c.externalValue,counterValue:De.value,dirty:s,class:["v-combobox",{"v-combobox--active-menu":g.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!_.value,"v-combobox--selecting-index":f.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:G.isReadonly.value,placeholder:s?void 0:e.placeholder,"onClick:clear":Te,"onMousedown:control":Ee,onKeydown:Le}),{...r,default:()=>a(Z,null,[a(Ze,E({ref:ue,modelValue:g.value,"onUpdate:modelValue":o=>g.value=o,activator:"parent",contentClass:"v-combobox__content",disabled:le.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:Ne,onAfterLeave:Be},e.menuProps),{default:()=>[t&&a(Je,E({ref:ae,selected:Ae.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:o=>o.preventDefault(),onKeydown:Re,onFocusin:Ue,onFocusout:Ge,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},Ie,e.listProps),{default:()=>{var o,d,C;return[(o=r["prepend-item"])==null?void 0:o.call(r),!P.value.length&&!e.hideNoData&&(((d=r["no-data"])==null?void 0:d.call(r))??a(ve,{title:n(e.noDataText)},null)),a(Xe,{ref:X,renderless:!0,items:P.value},{default:A=>{var fe;let{item:p,index:I,itemRef:k}=A;const de=E(p.props,{ref:k,key:I,active:te.value&&I===0?!0:void 0,onClick:()=>x(p,null)});return((fe=r.item)==null?void 0:fe.call(r,{item:p,index:I,props:de}))??a(ve,E(de,{role:"option"}),{prepend:j=>{let{isSelected:z}=j;return a(Z,null,[e.multiple&&!e.hideSelected?a($e,{key:p.value,modelValue:z,ripple:!1,tabindex:"-1"},null):void 0,p.props.prependAvatar&&a(et,{image:p.props.prependAvatar},null),p.props.prependIcon&&a(ge,{icon:p.props.prependIcon},null)])},title:()=>{var j,z;return u.value?p.title:Pt(p.title,(j=Pe(p))==null?void 0:j.title,((z=h.value)==null?void 0:z.length)??0)}})}}),(C=r["append-item"])==null?void 0:C.call(r)]}})]}),c.value.map((o,d)=>{function C(k){k.stopPropagation(),k.preventDefault(),x(o,!1)}const A={"onClick:close":C,onKeydown(k){k.key!=="Enter"&&k.key!==" "||(k.preventDefault(),k.stopPropagation(),C(k))},onMousedown(k){k.preventDefault(),k.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},p=M.value?!!r.chip:!!r.selection,I=p?bt(M.value?r.chip({item:o,index:d,props:A}):r.selection({item:o,index:d})):void 0;if(!(p&&!I))return a("div",{key:o.value,class:["v-combobox__selection",d===f.value&&["v-combobox__selection--selected",Se.value]],style:d===f.value?_e.value:{}},[M.value?r.chip?a(lt,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:o.title}}},{default:()=>[I]}):a(tt,E({key:"chip",closable:e.closableChips,size:"small",text:o.title,disabled:o.props.disabled},A),null):I??a("span",{class:"v-combobox__selection-text"},[o.title,e.multiple&&d<c.value.length-1&&a("span",{class:"v-combobox__selection-comma"},[b(",")])])])})]),"append-inner":function(){var A;for(var o=arguments.length,d=new Array(o),C=0;C<o;C++)d[C]=arguments[C];return a(Z,null,[(A=r["append-inner"])==null?void 0:A.call(r,...d),(!e.hideNoData||e.items.length)&&e.menuIcon?a(ge,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:Fe,onClick:pt,"aria-label":n(re.value),title:n(re.value),tabindex:"-1"},null):void 0])}})}),at({isFocused:y,isPristine:u,menu:g,search:h,selectionIndex:f,filteredItems:O,select:x},m)}}),Tt={components:{TelegramLogin:Dt,PromptChat:nt},computed:st(["loggedInGoogle","userGoogle"]),watch:{},async mounted(){try{const e=await H.get("/api/nse/instruments");this.etfList=e.data.map(l=>({value:l.symbol,title:"("+l.symbol+") "+l.underlying}))}catch(e){console.log(e)}},data(){return{userInput:"",messages:[],isLoading:!1,selectionCriteriaDialog:!1,etfList:[],etfSelected:[],base_amt:100,base_amtShort:"100",trigger:1,buy_factor:1,snackbar:{show:!1,message:"",timeout:3e3,color:"orange"},showSaveConfigDialog:!1,title:"Your Financial Assistant",subTitles:["Ask about DipSIP and how it is useful"],userInputLabel:"Ask about DipSIP. No Trading tips.",debug:!1,systemPrompt:"dipsip"}},methods:{async sendMessage(){},async saveConfig(){this.showSaveConfigDialog=!0},frameworkParamsChanged(){this.base_amt=this.base_amtShort.indexOf(" k")>-1?this.base_amtShort.substring(0,this.base_amtShort.length-2)*1e3:this.base_amtShort*1},async deleteConfig(){try{(await H.post("/api/db/saveconfig",{tg_id:this.$store.state.userGoogle.tg_id,unsubscribe:!0})).status==200?(this.snackbar.show=!0,this.snackbar.message="Unsubscribed !",this.snackbar.color="success"):(this.snackbar.show=!0,this.snackbar.message="Pls try later !",this.snackbar.color="error")}catch{this.snackbar.show=!0,this.snackbar.message="Pls try later !",this.snackbar.color="error"}},async handleTelegramAuth(e){try{const l=await H.post("/api/telegram/auth",{userTG:e,userGoogle:this.userGoogle}),{token:S,userRecord:r,configRecord:n}=l.data;if(this.accountExpiry=new Date(r.expiry_date),n){if(n.base_amt&&(this.base_amt=n.base_amt,this.base_amtShort=this.base_amt/1e3+" k"),n.trigger&&(this.trigger=n.trigger),n.buy_factor&&(this.buy_factor=n.buy_factor),n.instrument){this.etfSelected=[];const m=n.instrument.split(",");for(const y of m)this.etfSelected.push(this.etfList.find(u=>u.value===y.trim()))}}else console.log("No User Config Saved so far")}catch(l){console.error("Authentication failed:",l)}},async saveConfigApi(){this.showSaveConfigDialog=!1;try{const e=localStorage.getItem("jwt");(await H.post("/api/db/saveconfig",{tg_id:this.userGoogle.tg_id,trigger:this.trigger,base_amt:this.base_amt,buy_factor:this.buy_factor,instrument:this.etfSelected.map(S=>S.value).join(", ")},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}})).status==200?(this.snackbar.show=!0,this.snackbar.message="Params Saved",this.snackbar.color="success"):(this.snackbar.show=!0,this.snackbar.message="Params Not Saved",this.snackbar.color="error")}catch{this.snackbar.show=!0,this.snackbar.message="Params Not Saved",this.snackbar.color="error"}},scrollToBottom(){const e=this.$refs.messagesContainer;e&&(e.scrollTop=e.scrollHeight)}}};function Et(e,l,S,r,n,m){const y=ct("v-card-action");return F(),oe(ot,{fluid:"",class:"fill-height pa-0"},{default:i(()=>[a(ut,null,{default:i(()=>[a(L,{"no-gutters":"",class:"fill-height"},{default:i(()=>[a(T),a(T,{cols:"12",md:"6",order:"first","order-md":"first",class:"left-panel"},{default:i(()=>[a(K,{class:"fill-height d-flex flex-column ma-2"},{default:i(()=>[a(q,{class:"text-wrap"},{default:i(()=>l[11]||(l[11]=[b("Regret Buying on Highs ?")])),_:1}),a(it,null,{default:i(()=>l[12]||(l[12]=[b("Try DipSIP. A proven contra strategy.")])),_:1}),a(N,{class:"d-flex align-center flex-wrap"},{default:i(()=>[l[13]||(l[13]=V("span",null,"Select ETFs below, Invest Rs.",-1)),a(he,{theme:"light","onUpdate:menu":m.frameworkParamsChanged,modelValue:n.base_amtShort,"onUpdate:modelValue":l[0]||(l[0]=u=>n.base_amtShort=u),items:["100","1 k","2 k","5 k","10 k","20 k","50 k"],variant:"underlined",label:"",class:"mx-1 mb-4",style:{"max-width":"70px","min-width":"50px"},density:"compact","hide-details":""},null,8,["onUpdate:menu","modelValue"]),l[14]||(l[14]=V("span",null,"in each, whenever they dip by more than",-1)),a(he,{theme:"light",label:"","max-width":"40px","onUpdate:menu":m.frameworkParamsChanged,modelValue:n.trigger,"onUpdate:modelValue":l[1]||(l[1]=u=>n.trigger=u),items:["1","2","3","4","5"],variant:"underlined",class:"mx-1 mb-4",density:"compact","hide-details":""},null,8,["onUpdate:menu","modelValue"]),l[15]||(l[15]=V("span",null," %, any day.",-1))]),_:1}),a(L,{"no-gutters":"",class:"mt-2"},{default:i(()=>[a(T,{cols:"12"},{default:i(()=>[a(K,{class:"pb-2",color:"amber",theme:"light","max-width":"100%"},{default:i(()=>[a(q,{class:"d-flex justify-space-between align-center"},{default:i(()=>[l[16]||(l[16]=b(" Select Your ETFs ")),V("a",{href:"#",onClick:l[2]||(l[2]=rt(u=>n.selectionCriteriaDialog=!0,["prevent"])),class:"text-right text-decoration-none"}," Selection Criteria ")]),_:1}),a(It,{multiple:"",modelValue:n.etfSelected,"onUpdate:modelValue":l[3]||(l[3]=u=>n.etfSelected=u),items:n.etfList,variant:"outlined"},null,8,["modelValue","items"]),a(ye,{modelValue:n.selectionCriteriaDialog,"onUpdate:modelValue":l[5]||(l[5]=u=>n.selectionCriteriaDialog=u),width:"500"},{default:i(()=>[a(K,{class:"pb-2",color:"amber",theme:"light","max-width":"100%"},{default:i(()=>[a(q,{class:"text-h5 grey lighten-2"},{default:i(()=>l[17]||(l[17]=[b(" Selection Criteria ")])),_:1}),a(y,null,{default:i(()=>[a(ne,{class:"v-btn v-theme--light text-primary v-btn--density-default v-btn--size-default v-btn--variant-outlined",block:"",onClick:l[4]||(l[4]=u=>n.selectionCriteriaDialog=!1)},{default:i(()=>l[18]||(l[18]=[b("Close")])),_:1})]),_:1}),a(N,{class:"mt-4"},{default:i(()=>l[19]||(l[19]=[V("ul",null,[V("li",null," One of the core objectives of this Platform is to declutter and filter the investment options for end users. "),V("li",null," With more than 2500 Mutual Fund schemes alone, it is tough to filter. Cost comes later. "),V("li",null," We believe Passive Investments offer best risk adjusted returns over long term. "),V("li",null," Hence, we will present to users well-researched ETFs, which are low cost, liquid and there is public data to analyze them. "),V("li",null,[b(" See section "),V("a",{href:"etfList"},"ETFs"),b(" for more details ")])],-1)])),_:1})]),_:1})]),_:1},8,["modelValue"]),a(se,null,{default:i(()=>[e.loggedInGoogle==!0&&e.userGoogle.tg_id!==""?(F(),ie("button",{key:0,onClick:l[6]||(l[6]=(...u)=>m.saveConfig&&m.saveConfig(...u)),class:"v-btn v-theme--light text-primary v-btn--density-default v-btn--size-default v-btn--variant-outlined"}," Save ")):Q("",!0),e.loggedInGoogle==!0&&e.userGoogle.tg_id!==""?(F(),ie("button",{key:1,onClick:l[7]||(l[7]=(...u)=>m.deleteConfig&&m.deleteConfig(...u)),class:"v-btn v-theme--light text-primary v-btn--density-default v-btn--size-default v-btn--variant-outlined"}," Unsubscribe ")):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e.loggedInGoogle?(F(),oe(L,{key:0},{default:i(()=>[e.userGoogle.tg_id==""?(F(),oe(T,{key:0})):Q("",!0)]),_:1})):Q("",!0),a(L,{"no-gutters":"",class:"mt-1"},{default:i(()=>[a(ye,{modelValue:n.showSaveConfigDialog,"onUpdate:modelValue":l[9]||(l[9]=u=>n.showSaveConfigDialog=u),"max-width":"430px"},{default:i(()=>[a(K,{theme:"light",color:"secondary",dense:""},{default:i(()=>[a(q,{class:"d-flex justify-space-between align-center"},{default:i(()=>l[20]||(l[20]=[b(" Confirm Your Parameters ")])),_:1}),a(L,null,{default:i(()=>[a(T,{cols:"4"},{default:i(()=>[a(N,null,{default:i(()=>[b("Amount: "+Y(n.base_amt),1)]),_:1})]),_:1}),a(T,{cols:"4"},{default:i(()=>[a(N,null,{default:i(()=>[b("Trigger: "+Y(n.trigger),1)]),_:1})]),_:1})]),_:1}),a(N,null,{default:i(()=>[b("ETFs: "+Y(n.etfSelected.map(u=>u.title).join(", ")),1)]),_:1}),a(se,null,{default:i(()=>[a(ne,{block:"",onClick:m.saveConfigApi},{default:i(()=>l[21]||(l[21]=[b("Save")])),_:1},8,["onClick"])]),_:1}),a(se,null,{default:i(()=>[a(ne,{block:"",onClick:l[8]||(l[8]=u=>n.showSaveConfigDialog=!1)},{default:i(()=>l[22]||(l[22]=[b("Cancel")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(wt,{modelValue:n.snackbar.show,"onUpdate:modelValue":l[10]||(l[10]=u=>n.snackbar.show=u),timeout:n.snackbar.timeout,color:n.snackbar.color},{default:i(()=>[b(Y(n.snackbar.message),1)]),_:1},8,["modelValue","timeout","color"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Ut=ke(Tt,[["render",Et],["__scopeId","data-v-329881ef"]]);export{Ut as default};
//# sourceMappingURL=DipSipChat-DxpQmo18.js.map
