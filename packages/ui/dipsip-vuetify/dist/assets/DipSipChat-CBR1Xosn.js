import{_ as F,m as T,a as P,V as E,b as g,c as h,d as p,e as b,f as I,g as m,h as C,i as U,j as L,k as y,l as _,n as D,o as G,p as R}from"./index-ehztovRB.js";import{D as O,I as M,a as N,b as q,G as j,V as Y}from"./VAutocomplete-txUWNNvf.js";import{O as A,P as l,N as v,m as s,Q as r,R as u,Z as B,n as z,V as c,S,_ as V,$ as W}from"./vue-Ci2-vDhJ.js";import{V as k}from"./VDialog-B65GyVSG.js";import"./vuetify-DvIUftl9.js";const H={components:{},computed:T(["loggedInGoogle","userGoogle"]),watch:{async loggedInGoogle(a){},async userGoogle(a){a&&a.email&&(this.fundList.length===0&&await this.fetchFundList(),await this.getUserMFPortfolio())}},async mounted(){},data(){return{userInput:"",messages:[],isLoading:!1,selectionCriteriaDialog:!1,fundList:[],selectedFunds:[],portfolio:[],searchText:"",etfList:[],etfSelected:[],base_amt:100,base_amtShort:"100",trigger:1,buy_factor:1,snackbar:{show:!1,message:"",timeout:3e3,color:"orange"},showSaveConfigDialog:!1,title:"Your Financial Assistant",subTitles:["Ask about DipSIP and how it is useful"],userInputLabel:"Ask about DipSIP. No Trading tips.",debug:!1,systemPrompt:"dipsip"}},methods:{async sendMessage(){},async saveConfig(){await this.updatePortfolio(),await this.saveConfigKeyVal(),this.snackbar.message="Saved",this.snackbar.color="green",this.snackbar.show=!0},async deleteConfig(){try{await this.$apollo.query({query:O,variables:{email:this.userGoogle.email,key:"dipsip_etf_config"},fetchPolicy:"no-cache"}),this.snackbar.message="Unsubscribed",this.snackbar.color="green",this.snackbar.show=!0,await this.getUserMFPortfolio()}catch(a){console.error(a)}},async saveConfigKeyVal(){try{await this.$apollo.query({query:M,variables:{object:{key:"dipsip_etf_config",value:JSON.stringify({trigger:this.trigger,base_amt:this.base_amt,buy_factor:this.buy_factor}),user:{data:{email:this.userGoogle.email,google_id:this.userGoogle.uid},on_conflict:{constraint:"users_email_key",update_columns:["email"]}}}},fetchPolicy:"no-cache"})}catch(a){console.error(a)}},handleSearch(a){this.searchText=a},frameworkParamsChanged(){},customFilter(a,e){const i=a.toLowerCase();return e.toLowerCase().split(/\s+/).every(n=>i.includes(n))},async updatePortfolio(){const a=new Set(this.portfolio.map(t=>t.id)),e=new Set(this.selectedFunds.map(t=>t.id)),i=this.selectedFunds.filter(t=>!a.has(t.id)),d=this.portfolio.filter(t=>!e.has(t.id));for(const[t,n]of i.entries())try{const f=await this.$apollo.query({query:N,variables:{object:{mutual_fund_id:n.id,user:{data:{email:this.userGoogle.email,google_id:this.userGoogle.uid},on_conflict:{constraint:"users_email_key",update_columns:["email"]}}}},fetchPolicy:"no-cache"})}catch(f){console.error(f)}for(const[t,n]of d.entries())try{const f=await this.$apollo.query({query:q,variables:{mutual_fund_id:n.id,email:this.userGoogle.email},fetchPolicy:"no-cache"})}catch(f){console.error(f)}},async getUserMFPortfolio(){if(this.userGoogle.email)try{const a=await this.$apollo.query({query:j,variables:{email:this.userGoogle.email}});this.selectedMFs=a.data.portfolio_mutual_funds.filter(i=>i.mutual_fund.isDipSipETF===!0).map(i=>{let d=i.mutual_fund.return_3Y?" (3 Y Returns "+i.mutual_fund.return_3Y+" %)":"";for(let t=1;t<=i.mutual_fund.star_rating;t++)d+="⭐";return{id:i.mutual_fund.id,name:i.mutual_fund.name,displayName:i.mutual_fund.name+d}}),this.selectedFunds=this.selectedMFs,this.portfolio=this.selectedMFs;const e=a.data.users[0].user_configs.filter(i=>i.key==="dipsip_etf_config");if(e&&e.length>0){const i=JSON.parse(e[0].value);this.trigger=i.trigger,this.base_amt=i.base_amt,this.buy_factor=i.buy_factor}else this.trigger=1,this.base_amt=100,this.buy_factor=1}catch(a){console.error(a)}},async fetchFundList(){try{const a=await P.get("/api/mutualfunds/list?isDipSipETF=true");this.fundList=a.data.map(e=>{let i=e.return_3Y?" (3 Y Returns "+e.return_3Y+" %)":"";for(let d=1;d<=e.star_rating;d++)i+="⭐";return{id:e.id,name:e.name,displayName:e.name+i}})}catch(a){console.error("Error fetching fund list:",a)}},scrollToBottom(){const a=this.$refs.messagesContainer;a&&(a.scrollTop=a.scrollHeight)}}};function J(a,e,i,d,t,n){const f=R,x=W("v-card-action");return v(),A(E,{fluid:"",class:"fill-height pa-0"},{default:l(()=>[s(G,null,{default:l(()=>[s(g,{"no-gutters":"",class:"fill-height"},{default:l(()=>[s(h,{cols:"12"},{default:l(()=>[s(p,{class:"fill-height d-flex flex-column ma-2"},{default:l(()=>[s(b,{class:"text-wrap"},{default:l(()=>e[11]||(e[11]=[r("Regret Buying on Highs or Missing the Lows ?")])),_:1}),s(I,null,{default:l(()=>e[12]||(e[12]=[r("Try DipSIP. A proven contra strategy.")])),_:1}),s(m,{class:"d-flex align-center flex-wrap"},{default:l(()=>[s(f),e[13]||(e[13]=u("span",null,"Select ETFs below, Invest Rs.",-1)),s(C,{theme:"light","onUpdate:menu":n.frameworkParamsChanged,modelValue:t.base_amt,"onUpdate:modelValue":e[0]||(e[0]=o=>t.base_amt=o),items:["100","1000","2000","5000","10000"],variant:"underlined",label:"",class:"mx-1 mb-4",style:{"max-width":"80px","min-width":"50px"},density:"compact","hide-details":""},null,8,["onUpdate:menu","modelValue"]),e[14]||(e[14]=u("span",null,"in each, whenever they dip by more than",-1)),s(C,{theme:"light",label:"","max-width":"40px","onUpdate:menu":n.frameworkParamsChanged,modelValue:t.trigger,"onUpdate:modelValue":e[1]||(e[1]=o=>t.trigger=o),items:["1","2","3","4","5"],variant:"underlined",style:{"max-width":"50px","min-width":"50px"},class:"mx-1 mb-4",density:"compact","hide-details":""},null,8,["onUpdate:menu","modelValue"]),e[15]||(e[15]=u("span",null," %, any day.",-1))]),_:1}),s(g,{"no-gutters":"",class:"mt-2"},{default:l(()=>[s(h,{cols:"12"},{default:l(()=>[s(p,{class:"pb-2",color:"amber",theme:"light","max-width":"100%"},{default:l(()=>[s(b,{class:"d-flex justify-space-between align-center"},{default:l(()=>[e[16]||(e[16]=r(" Select Your Index Funds ")),u("a",{href:"#",onClick:e[2]||(e[2]=B(o=>t.selectionCriteriaDialog=!0,["prevent"])),class:"text-right text-decoration-none"}," Selection Criteria ")]),_:1}),s(Y,{modelValue:t.selectedFunds,"onUpdate:modelValue":e[3]||(e[3]=o=>t.selectedFunds=o),items:t.fundList,"item-title":"displayName","custom-filter":n.customFilter,"item-value":"id",label:"Select Mutual Funds "+(t.selectedFunds.length?`(${t.selectedFunds.length} selected)`:""),multiple:"",chips:"","return-object":"","closable-chips":"","persistent-hint":"",hint:"Partial match works while typing e.g. 'Motilal Small'",search:t.searchText,"onUpdate:search":n.handleSearch},{chip:l(({props:o,item:w})=>[s(U,z(o,{text:w.raw.name,variant:"elevated"}),{default:l(()=>[s(L,{start:""},{default:l(()=>e[17]||(e[17]=[r("$mdiChartLine")])),_:1}),r(" "+c(w.raw.name),1)]),_:2},1040,["text"])]),_:1},8,["modelValue","items","custom-filter","label","search","onUpdate:search"]),s(k,{modelValue:t.selectionCriteriaDialog,"onUpdate:modelValue":e[5]||(e[5]=o=>t.selectionCriteriaDialog=o),width:"500"},{default:l(()=>[s(p,{class:"pb-2",color:"amber",theme:"light","max-width":"100%"},{default:l(()=>[s(b,{class:"text-h5 grey lighten-2"},{default:l(()=>e[18]||(e[18]=[r(" Selection Criteria ")])),_:1}),s(x,null,{default:l(()=>[s(y,{class:"v-btn v-theme--light text-primary v-btn--density-default v-btn--size-default v-btn--variant-outlined",block:"",onClick:e[4]||(e[4]=o=>t.selectionCriteriaDialog=!1)},{default:l(()=>e[19]||(e[19]=[r("Close")])),_:1})]),_:1}),s(m,{class:"mt-4"},{default:l(()=>e[20]||(e[20]=[u("ul",null,[u("li",null," One of the core objectives of this Platform is to declutter and filter the investment options for end users. "),u("li",null," With more than 2500 Mutual Fund schemes alone, it is tough to filter. Cost comes later. "),u("li",null," We believe Passive Investments offer best risk adjusted returns over long term. "),u("li",null," Hence, we will present to users de-duplicated ETFs, which are low cost, liquid and there is public data to analyze them. "),u("li",null,[r(" See section "),u("a",{href:"etfList"},"ETFs"),r(" for more details ")])],-1)])),_:1})]),_:1})]),_:1},8,["modelValue"]),s(_,null,{default:l(()=>[a.loggedInGoogle==!0&&a.userGoogle.tg_id!==""?(v(),S("button",{key:0,onClick:e[6]||(e[6]=(...o)=>n.saveConfig&&n.saveConfig(...o)),class:"v-btn v-theme--light text-primary v-btn--density-default v-btn--size-default v-btn--variant-outlined"}," Save ")):V("",!0),a.loggedInGoogle==!0&&a.userGoogle.tg_id!==""?(v(),S("button",{key:1,onClick:e[7]||(e[7]=(...o)=>n.deleteConfig&&n.deleteConfig(...o)),class:"v-btn v-theme--light text-primary v-btn--density-default v-btn--size-default v-btn--variant-outlined"}," Unsubscribe ")):V("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),s(g,{"no-gutters":"",class:"mt-1"},{default:l(()=>[s(k,{modelValue:t.showSaveConfigDialog,"onUpdate:modelValue":e[9]||(e[9]=o=>t.showSaveConfigDialog=o),"max-width":"430px"},{default:l(()=>[s(p,{theme:"light",color:"secondary",dense:""},{default:l(()=>[s(b,{class:"d-flex justify-space-between align-center"},{default:l(()=>e[21]||(e[21]=[r(" Confirm Your Parameters ")])),_:1}),s(g,null,{default:l(()=>[s(h,{cols:"4"},{default:l(()=>[s(m,null,{default:l(()=>[r("Amount: "+c(t.base_amt),1)]),_:1})]),_:1}),s(h,{cols:"4"},{default:l(()=>[s(m,null,{default:l(()=>[r("Trigger: "+c(t.trigger),1)]),_:1})]),_:1})]),_:1}),s(m,null,{default:l(()=>[r("ETFs: "+c(t.etfSelected.map(o=>o.title).join(", ")),1)]),_:1}),s(_,null,{default:l(()=>[s(y,{block:"",onClick:a.saveConfigApi},{default:l(()=>e[22]||(e[22]=[r("Save")])),_:1},8,["onClick"])]),_:1}),s(_,null,{default:l(()=>[s(y,{block:"",onClick:e[8]||(e[8]=o=>t.showSaveConfigDialog=!1)},{default:l(()=>e[23]||(e[23]=[r("Cancel")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(D,{modelValue:t.snackbar.show,"onUpdate:modelValue":e[10]||(e[10]=o=>t.snackbar.show=o),timeout:t.snackbar.timeout,color:t.snackbar.color},{default:l(()=>[r(c(t.snackbar.message),1)]),_:1},8,["modelValue","timeout","color"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const ee=F(H,[["render",J],["__scopeId","data-v-b2d37aaa"]]);export{ee as default};
//# sourceMappingURL=DipSipChat-CBR1Xosn.js.map
